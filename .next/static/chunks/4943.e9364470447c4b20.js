"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4943],{9844:function(e,n,t){var r=t(88767),a=t(84626),o=t(45354);n.Z=()=>{let{data:e,error:n}=(0,r.useQuery)("home",a.Z.getHome,{staleTime:o.ok,keepPreviousData:!0,cacheTime:o.bQ,refetchOnWindowFocus:!1}),{data:t,error:i,refetch:s,isLoading:l}=(0,r.useQuery)("chat-history",a.Z.getChatHistory,{staleTime:o.ok,keepPreviousData:!0,cacheTime:o.bQ,refetchOnWindowFocus:!1});return{homeData:e,homeError:n,chatHistory:t,chatHistoryError:i,refetchChatList:s,chatLoading:l}}},74943:function(e,n,t){t.r(n),t.d(n,{default:function(){return tH}});var r,a,o,i,s,l,c,u,d,p,g,f,h,m,v,x,y,Z,C,k,b,M,w,j,S,T,N,R,E,z,A,D,I,P,B,H,F,O,L,_,U,W,Q,V,X,G=t(35944),Y=t(51024),q=t(67294),K=t(84626),J=t(34973),$=t(1413),ee=t(45987),en=t(57605),et=t(97685),er=t(30168),ea=t(65400),eo=t.n(ea),ei=t(31535),es=(0,J.kc)(function(e){var n=e.css,t=(0,J.F4)(o||(o=(0,er.Z)(["\n  0% {\n    rotate: 0deg;\n  }\n  100% {\n    rotate: 360deg;\n  }\n  "])));return{spin:n(i||(i=(0,er.Z)(["\n      animation: "," 1s linear infinite;\n    "])),t)}}),el=t(85893),ec=["icon","size","color","fill","className","spin"],eu=function(e){var n,t;switch(e){case"large":n=24,t=2;break;case"normal":n=20,t=2;break;case"small":n=14,t=1.5;break;default:e?(n=(null==e?void 0:e.fontSize)||24,t=(null==e?void 0:e.strokeWidth)||2):(n="1em",t=2)}return{fontSize:n,strokeWidth:t}},ed=(0,q.memo)(function(e){var n=e.icon,t=e.size,r=e.color,a=e.fill,o=e.className,i=e.spin,s=(0,ee.Z)(e,ec),l=es(),c=l.styles,u=l.cx,d=(0,q.useMemo)(function(){return eu(t)},[t]),p=d.fontSize,g=d.strokeWidth;return(0,el.jsx)("span",(0,$.Z)((0,$.Z)({className:u("anticon",i&&c.spin,o),role:"img"},s),{},{children:(0,el.jsx)(n,{color:r,fill:null!=a?a:"transparent",focusable:!1,height:p,size:p,strokeWidth:g,width:p})}))}),ep=(0,J.kc)(function(e,n){var t=e.token,r=e.css,a=e.stylish;return(0,e.cx)(a.blur,r(s||(s=(0,er.Z)(["\n      pointer-events: ",";\n\n      transform: translateY(",");\n\n      padding-inline: 12px !important;\n\n      opacity: ",";\n      background: ",";\n      border-color: "," !important;\n      border-radius: 16px !important;\n      backdrop-filter: blur(16px);\n    "])),n?"all":"none",n?0:"16px",n?1:0,t.colorFillSecondary,t.colorFillTertiary))}),eg=function(e){var n=e||{},t=n.visibilityHeight,r=void 0===t?240:t,a=n.target,o=n.onClick,i=n.style,s=n.className,l=n.text,c=n.render,u=n.onScroll,d=n.alwaysShow,p=void 0!==d&&d,g=(0,q.useState)(p),f=(0,et.Z)(g,2),h=f[0],m=f[1],v=ep(h),x=v.styles,y=v.cx,Z=(0,q.useRef)(null),C=(0,q.useState)(!1),k=(0,et.Z)(C,2),b=k[0],M=k[1];(0,q.useEffect)(function(){M(!0)},[]);var w=(0,q.useMemo)(function(){return a.current?a.current:document.body},[b]),j=(null==w?void 0:w.scrollHeight)||0,S=(null==w?void 0:w.clientHeight)||0,T=(0,q.useState)({top:0,left:0}),N=(0,et.Z)(T,2),R=N[0],E=N[1],z=(0,q.useRef)(null);(0,q.useEffect)(function(){if(void 0!==w){var e,n=function(e){null==u||u(e),z.current=window.setTimeout(function(){p||m((null==w?void 0:w.scrollTop)+S+r<j),E({top:null==w?void 0:w.scrollTop,left:null==w?void 0:w.scrollLeft})},60)};return null==w||null===(e=w.addEventListener)||void 0===e||e.call(w,"scroll",n,{passive:!0}),function(){var e;z.current&&clearTimeout(z.current),null==w||null===(e=w.removeEventListener)||void 0===e||e.call(w,"scroll",n)}}},[w]),(0,q.useEffect)(function(){p||m((null==R?void 0:R.top)+S+r<j)},[j,R,r,w]);var A=function(e){var n;null==a||null===(n=a.current)||void 0===n||n.scrollTo({behavior:"smooth",left:0,top:j}),null==o||o(e)};(0,q.useEffect)(function(){setTimeout(function(){var e;null==a||null===(e=a.current)||void 0===e||e.scrollTo({behavior:"smooth",left:0,top:j})},16)},[]);var D=(0,el.jsx)(eo(),{className:y(x,s),icon:(0,el.jsx)(ed,{icon:ei.Z}),onClick:A,ref:Z,size:"small",style:(0,$.Z)({bottom:18,position:"absolute",right:16},i),children:l||"Back to bottom"});return c?c(D,A,e):D},ef=t(9220),eh=t(17542),em=t(31929),ev=t(20640),ex=t.n(ev),ey=t(27950),eZ=(0,q.memo)(function(e){var n=e.actions,t=e.className;return(0,el.jsx)(eh.D,{align:"flex-start",className:t,role:"menubar",children:n})}),eC=t(84960),ek=(0,J.kc)(function(e){var n=e.css,t=e.token;return{container:n(l||(l=(0,er.Z)(["\n      position: relative;\n\n      display: flex;\n      align-items: center;\n      justify-content: center;\n\n      line-height: 1;\n      text-align: center;\n    "]))),loading:n(c||(c=(0,er.Z)(["\n      position: absolute;\n      inset: 0;\n\n      display: flex;\n      align-items: center;\n      justify-content: center;\n\n      width: 100%;\n      height: 100%;\n\n      color: ",";\n    "])),t.colorText)}}),eb=(0,q.memo)(function(e){var n=e.emoji,t=e.className,r=e.style,a=e.size,o=void 0===a?40:a,i=ek(),s=i.cx,l=i.styles;return(0,el.jsx)("div",{className:s(l.container,t),style:(0,$.Z)({fontSize:.9*o,height:o,width:o},r),children:n})}),eM=t(24571),ew=function(e){var n,t=(0,eM.Z)();return null===(n=e.match(t))||void 0===n?void 0:n[0]},ej=t(84967),eS=(0,J.kc)(function(e,n){var t=e.css,r=e.token,a=e.prefixCls,o=n.background,i=n.size,s=n.isEmoji,l=null!=o?o:r.colorBgContainer,c=(0,ej.XV)(l);return{avatar:t(u||(u=(0,er.Z)(["\n        cursor: pointer;\n\n        display: flex;\n        align-items: center;\n        justify-content: center;\n\n        background: ",";\n        border: 1px solid ",";\n\n        > .","-avatar-string {\n          font-size: ","px;\n          font-weight: 700;\n          line-height: 1 !important;\n          color: ",";\n        }\n\n        > * {\n          cursor: pointer;\n        }\n      "])),l,o?"transparent":r.colorSplit,a,i*(s?.7:.5),c)}}),eT=["className","avatar","title","size","shape","background","onClick","style"],eN=(0,q.memo)(function(e){var n=e.className,t=e.avatar,r=e.title,a=e.size,o=void 0===a?40:a,i=e.shape,s=e.background,l=e.onClick,c=e.style,u=(0,ee.Z)(e,eT),d=!!(t&&["/","http","data:"].some(function(e){return t.startsWith(e)})),p=!!(null==t?void 0:t.startsWith("data")),g=(0,q.useMemo)(function(){return t&&!d&&ew(t)},[t]),f=eS({background:void 0===s?"rgba(0,0,0,0)":s,isEmoji:!!g,size:o}),h=f.styles,m=f.cx,v=String(d?r:t),x={className:m(h.avatar,n),shape:void 0===i?"circle":i,size:o,style:l?c:(0,$.Z)({cursor:"default"},c)};return d?(0,el.jsx)(eC.ZP,(0,$.Z)((0,$.Z)({src:p?t:(0,el.jsx)("img",{src:t,alt:"avatar"})},x),u)):(0,el.jsx)(eC.ZP,(0,$.Z)((0,$.Z)((0,$.Z)({},x),u),{},{children:g?(0,el.jsx)(eb,{emoji:g,size:.8*o}):null==v?void 0:v.toUpperCase().slice(0,2)}))}),eR=(0,J.kc)(function(e,n){var t=e.cx,r=e.css,a=e.token,o=e.isDarkMode,i=e.responsive,s=n.placement,l=n.type,c=n.title,u=n.primary,R=n.avatarSize,E=n.showTitle,z=n.editing,A=r(d||(d=(0,er.Z)(["\n      padding: 8px 12px;\n      background-color: ",";\n      border-radius: ","px;\n      transition: background-color 100ms ",";\n    "])),u?o?a.colorFill:a.colorBgElevated:o?a.colorFillSecondary:a.colorBgContainer,a.borderRadiusLG,a.motionEaseOut),D=r(p||(p=(0,er.Z)(["\n      padding-top: ",";\n    "])),c?0:"6px"),I=r(g||(g=(0,er.Z)(["\n      margin-bottom: -16px;\n      transition: background-color 100ms ",";\n    "])),a.motionEaseOut),P="block"===l?A:D,B=z&&r(f||(f=(0,er.Z)(["\n        width: 100%;\n      "])));return{actions:t(r(h||(h=(0,er.Z)(["\n          align-self: ",";\n          justify-content: ",";\n        "])),"block"===l?"flex-end":"left"===s?"flex-start":"flex-end","left"===s?"flex-end":"flex-start"),z&&r(m||(m=(0,er.Z)(["\n            pointer-events: none !important;\n            opacity: 0 !important;\n          "])))),alert:r(v||(v=(0,er.Z)([""]))),avatarContainer:r(x||(x=(0,er.Z)(["\n        position: relative;\n        flex: none;\n        width: ","px;\n        height: ","px;\n      "])),R,R),avatarGroupContainer:r(y||(y=(0,er.Z)(["\n        width: ","px;\n      "])),R),container:t("pure"===l&&I,r(Z||(Z=(0,er.Z)(["\n          position: relative;\n          width: 100%;\n          max-width: 100vw;\n          padding: 16px;\n          content-visibility: auto;\n          contain-intrinsic-size: 100px;\n          time {\n            display: inline-block;\n            white-space: nowrap;\n          }\n\n          div[role='menubar'] {\n            display: flex;\n          }\n\n          time,\n          div[role='menubar'] {\n            pointer-events: none;\n            opacity: 0;\n            transition: opacity 200ms ",";\n          }\n\n          &:hover {\n            time,\n            div[role='menubar'] {\n              pointer-events: unset;\n              opacity: 1;\n            }\n          }\n\n          "," {\n            padding: 4px 16px;\n          }\n        "])),a.motionEaseOut,i.mobile)),editingContainer:t(B,r(C||(C=(0,er.Z)(["\n          padding: 8px 12px 12px;\n          border: 1px solid ",";\n\n          &:active,\n          &:hover {\n            border-color: ",";\n          }\n        "])),a.colorBorderSecondary,a.colorBorder),"pure"===l&&r(k||(k=(0,er.Z)(["\n            background: ",";\n            border-radius: ","px;\n          "])),a.colorFillQuaternary,a.borderRadius)),editingInput:r(b||(b=(0,er.Z)(["\n        width: 100%;\n      "]))),loading:r(M||(M=(0,er.Z)(["\n        position: absolute;\n        right: ",";\n        bottom: 0;\n        left: ",";\n\n        width: 16px;\n        height: 16px;\n\n        color: ",";\n\n        background: ",";\n        border-radius: 50%;\n      "])),"left"===s?"-4px":"unset","right"===s?"-4px":"unset",a.colorBgLayout,a.colorPrimary),message:t(P,r(w||(w=(0,er.Z)(["\n          position: relative;\n        "])))),messageContainer:t(B,r(j||(j=(0,er.Z)(["\n          position: relative;\n        "])))),messageContent:t(B,r(S||(S=(0,er.Z)(["\n          position: relative;\n          overflow-x: hidden;\n\n          "," {\n            flex-direction: column !important;\n          }\n        "])),i.mobile)),messageExtra:r(T||(T=(0,er.Z)([""]))),name:r(N||(N=(0,er.Z)(["\n        position: ",";\n        top: ",";\n        right: ",";\n        left: ",";\n\n        margin-bottom: 6px;\n\n        font-size: 12px;\n        line-height: 1;\n        color: ",";\n        text-align: ",";\n      "])),E?"relative":"absolute",E?"unset":"-16px","right"===s?"0":"unset","left"===s?"0":"unset",a.colorTextDescription,"left"===s?"left":"right")}}),eE=t(3389),ez=(0,q.memo)(function(e){var n=e.loading,t=eR({placement:e.placement}).styles;return n?(0,el.jsx)(eh.D,{align:"center",className:t.loading,justify:"center",children:(0,el.jsx)(ed,{icon:eE.Z,size:{fontSize:12,strokeWidth:3},spin:!0})}):null}),eA=(0,q.memo)(function(e){var n=e.loading,t=e.avatar,r=void 0===t?{}:t,a=e.placement,o=e.addon,i=e.onClick,s=e.size,l=void 0===s?40:s,c=eR({avatarSize:l}).styles,u=(0,el.jsxs)("div",{className:c.avatarContainer,children:[(0,el.jsx)(eN,{avatar:r.avatar,background:r.backgroundColor,onClick:i,size:l,title:r.title}),(0,el.jsx)(ez,{loading:n,placement:a})]});return o?(0,el.jsxs)(eh.D,{align:"center",className:c.avatarGroupContainer,gap:8,children:[u,o]}):u}),eD=(0,q.memo)(function(e){var n=e.borderSpacing;return n?(0,el.jsx)("div",{style:{flex:"none",width:n}}):null}),eI=t(4863),eP=(0,q.memo)(function(e){var n=e.message,t=eR({placement:e.placement}).styles;return(0,el.jsx)(eh.D,{gap:8,children:(0,el.jsx)(eI.Z,{className:t.alert,showIcon:!0,type:"error",message:n})})}),eB=t(56790),eH=(0,J.kc)(function(e,n){var t=e.cx,r=e.css,a=e.token,o=e.prefixCls,i=n.type,s=r(R||(R=(0,er.Z)(["\n      background-color: ",";\n      border: 1px solid ",";\n      transition:\n        background-color 100ms ",",\n        border-color 200ms ",";\n\n      &:hover {\n        background-color: ",";\n      }\n\n      &:focus {\n        border-color: ",";\n      }\n\n      &.","-input-affix-wrapper-focused {\n        border-color: ",";\n      }\n    "])),"block"===i?a.colorFillTertiary:"transparent","block"===i?"transparent":a.colorBorder,a.motionEaseOut,a.motionEaseOut,a.colorFillTertiary,a.colorTextQuaternary,o,a.colorTextQuaternary);return{input:t("pure"!==i&&s,r(E||(E=(0,er.Z)(["\n          position: relative;\n          max-width: 100%;\n          height: ",";\n          padding: ",";\n\n          input {\n            background: transparent;\n          }\n        "])),"pure"===i?"unset":"36px","pure"===i?"0":"0 12px")),textarea:t("pure"!==i&&s,r(z||(z=(0,er.Z)(["\n          position: relative;\n          max-width: 100%;\n          padding: ",";\n          border-radius: ",";\n\n          textarea {\n            background: transparent;\n          }\n        "])),"pure"===i?"0":"8px 12px","pure"===i?"0":"".concat(a.borderRadius,"px")))}}),eF=["className","type","resize","style"],eO=(0,q.forwardRef)(function(e,n){var t=e.className,r=e.type,a=void 0===r?"ghost":r,o=e.resize,i=e.style,s=(0,ee.Z)(e,eF),l=eH({type:a}),c=l.styles,u=l.cx;return(0,el.jsx)(Y.default.TextArea,(0,$.Z)({bordered:"pure"!==a,className:u(c.textarea,t),ref:n,style:void 0===o||o?i:(0,$.Z)({resize:"none"},i)},s))}),eL=(0,J.kc)(function(e){var n=e.css,t=e.token;return n(A||(A=(0,er.Z)(["\n    position: relative;\n\n    height: 100%;\n\n    font-family: ",";\n    font-size: 13px;\n    line-height: 1.8;\n  "])),t.fontFamilyCode)}),e_=["text","type","onCancel","defaultValue","onConfirm","renderButtons","textareaStyle","textareaClassname","placeholder","height","style","editButtonSize","classNames"],eU=(0,q.memo)(function(e){var n=e.text,t=e.type,r=e.onCancel,a=e.defaultValue,o=e.onConfirm,i=e.renderButtons,s=e.textareaStyle,l=e.textareaClassname,c=e.placeholder,u=e.height,d=void 0===u?"auto":u,p=e.style,g=e.editButtonSize,f=void 0===g?"middle":g,h=e.classNames,m=(0,ee.Z)(e,e_),v=(0,q.useState)(a||""),x=(0,et.Z)(v,2),y=x[0],Z=x[1],C=eL(),k=C.cx,b=C.styles,M="auto"===d;return(0,el.jsxs)(eh.D,(0,$.Z)((0,$.Z)({gap:16,style:(0,$.Z)({flex:1,width:"100%"},p)},m),{},{children:[(0,el.jsx)(eO,{autoSize:M,className:k(b,l),classNames:h,onBlur:function(e){return Z(e.target.value)},onChange:function(e){return Z(e.target.value)},placeholder:void 0===c?"Type something...":c,resize:!1,style:(0,$.Z)({height:M?"unset":d,minHeight:"100%"},s),type:void 0===t?"pure":t,value:y}),(0,el.jsx)(eh.D,{direction:"horizontal-reverse",gap:8,children:i?i(y).map(function(e,n){return(0,el.jsx)(eo(),(0,$.Z)({size:"small"},e),n)}):(0,el.jsxs)(el.Fragment,{children:[(0,el.jsx)(eo(),{onClick:function(){null==o||o(y)},size:f,type:"primary",children:(null==n?void 0:n.confirm)||"Confirm"}),(0,el.jsx)(eo(),{onClick:r,size:f,children:(null==n?void 0:n.cancel)||"Cancel"})]})})]}))}),eW=t(33914),eQ=t(56697),eV=(0,q.memo)(function(e){var n=e.editing,t=e.open,r=e.height,a=void 0===r?"auto":r,o=e.onOpenChange,i=e.onEditingChange,s=e.placeholder,l=e.value,c=e.onChange,u=e.text,d=e.footer,p=e.extra,g=e.markdownProps,f=(0,ey.F)().mobile,h=(0,eB.useMergedState)(!1,{onChange:i,value:n}),m=(0,et.Z)(h,2),v=m[0],x=m[1],y=(0,eB.useMergedState)(!1,{onChange:o,value:t}),Z=(0,et.Z)(y,2),C=Z[0],k=Z[1],b={height:"auto"===a?"unset":a,overflowX:"hidden",overflowY:"auto"};return(0,el.jsx)(eQ.default,{cancelText:(null==u?void 0:u.cancel)||"Cancel",footer:v?null:d,okText:(null==u?void 0:u.edit)||"Edit",onCancel:function(){return k(!1)},onOk:function(){return x(!0)},open:C,styles:f?{body:{padding:16}}:{},title:(null==u?void 0:u.title)||"Prompt",children:v?(0,el.jsx)(eU,{defaultValue:l,height:a,onCancel:function(){return x(!1)},onConfirm:function(e){x(!1),null==c||c(e)},placeholder:s,text:{cancel:null==u?void 0:u.cancel,confirm:null==u?void 0:u.confirm},type:"block"}):(0,el.jsxs)(el.Fragment,{children:[p,(0,el.jsx)(eW.Z,(0,$.Z)((0,$.Z)({},g),{},{style:l?(0,$.Z)((0,$.Z)({},b),null==g?void 0:g.style):(0,$.Z)((0,$.Z)((0,$.Z)({},b),null==g?void 0:g.style),{},{opacity:.5}),children:String(l||s)}))]})})}),eX=(0,q.memo)(function(e){var n=e.value,t=e.onChange,r=e.classNames,a=void 0===r?{}:r,o=e.onEditingChange,i=e.editing,s=e.openModal,l=e.onOpenChange,c=e.placeholder,u=void 0===c?"Type something...":c,d=e.showEditWhenEmpty,p=e.styles,g=e.height,f=e.inputType,h=e.editButtonSize,m=e.text,v=e.model,x=e.markdownProps,y=(0,eB.useMergedState)(!1,{onChange:o,value:i}),Z=(0,et.Z)(y,2),C=Z[0],k=Z[1],b=(0,eB.useMergedState)(!1,{onChange:l,value:s}),M=(0,et.Z)(b,2),w=M[0],j=M[1],S=(0,el.jsx)(eU,{className:null==a?void 0:a.input,classNames:{textarea:null==a?void 0:a.textarea},defaultValue:n,editButtonSize:h,height:g,onCancel:function(){return k(!1)},onConfirm:function(e){null==t||t(e),k(!1)},placeholder:u,style:null==p?void 0:p.input,text:m,textareaClassname:null==a?void 0:a.input,type:f});return!n&&void 0!==d&&d?S:(0,el.jsxs)(el.Fragment,{children:[!w&&C?S:(0,el.jsx)(eW.Z,(0,$.Z)((0,$.Z)({},x),{},{style:(0,$.Z)({height:"auto"===g?"unset":g,overflowX:"hidden",overflowY:"auto"},null==x?void 0:x.style),children:n||u})),(0,el.jsx)(eV,{editing:C,extra:null==v?void 0:v.extra,footer:null==v?void 0:v.footer,height:g,onChange:function(e){return null==t?void 0:t(e)},onEditingChange:k,onOpenChange:function(e){j(e),k(!1)},markdownProps:x,open:w,placeholder:u,text:m,value:n})]})}),eG=(0,q.memo)(function(e){var n=e.editing,t=e.onChange,r=e.onEditingChange,a=e.className,o=e.text,i=e.message,s=e.placement,l=e.messageExtra,c=e.renderMessage,u=e.markdownProps,d=e.type,p=e.primary,g=e.onDoubleClick,f=eR({editing:n,placement:s,primary:p,type:d}),h=f.cx,m=f.styles,v=(0,ey.F)().mobile,x=(0,(0,q.useContext)(em.default.ConfigContext).getPrefixCls)("pro-chat"),y=(0,el.jsx)(eX,{classNames:{input:m.editingInput},editButtonSize:"small",editing:n,fullFeaturedCodeBlock:!0,onChange:t,onEditingChange:r,openModal:v?n:void 0,text:o,value:String(i||"..."),markdownProps:u}),Z=c?c(y):y;return(0,el.jsxs)(eh.D,{className:h(m.message,a,n&&m.editingContainer),onDoubleClick:g,children:[Z,l&&!n?(0,el.jsx)("div",{className:"".concat(h(m.messageExtra,"".concat(x,"-message-extra"))),children:l}):null]})}),eY=t(27484),eq=t.n(eY);t(34155);var eK=function(e){var n=eq()(),t=eq()(e);return t.isSame(n,"day")?t.format("HH:mm:ss"):t.isSame(n,"year")?t.format("MM-DD HH:mm:ss"):t.format("YYYY-MM-DD HH:mm:ss")},eJ=(0,q.memo)(function(e){var n=e.showTitle,t=e.className,r=e.placement,a=e.time,o=e.avatar;return(0,el.jsxs)(eh.D,{className:t,direction:"left"===r?"horizontal":"horizontal-reverse",gap:4,children:[n?o.title||"untitled":void 0,a&&(0,el.jsx)("time",{children:eK(a)})]})}),e$=["avatarAddon","onAvatarClick","actions","className","primary","loading","message","placement","type","avatar","error","showTitle","time","editing","onChange","onEditingChange","messageExtra","renderMessage","text","chatItemRenderConfig","renderErrorMessages","markdownProps","onDoubleClick","originData"],e0=(0,q.memo)(function(e){var n,t=e.avatarAddon,r=e.onAvatarClick,a=e.actions,o=e.className,i=e.primary,s=e.loading,l=e.message,c=e.placement,u=void 0===c?"left":c,d=e.type,p=void 0===d?"block":d,g=e.avatar,f=e.error,h=e.showTitle,m=e.time,v=e.editing,x=e.onChange,y=e.onEditingChange,Z=e.messageExtra,C=e.renderMessage,k=e.text,b=e.chatItemRenderConfig,M=e.renderErrorMessages,w=e.markdownProps,j=e.onDoubleClick,S=e.originData,T=(0,ee.Z)(e,e$),N=(0,ey.F)().mobile,R=eR({editing:v,placement:u,primary:i,showTitle:h,title:g.title,type:p}),E=R.cx,z=R.styles,A=(0,(0,q.useContext)(em.default.ConfigContext).getPrefixCls)("pro-chat"),D=null==f?void 0:f.message,I=(0,q.useMemo)(function(){if((null==b?void 0:b.avatarRender)===!1)return null;var n,a=(0,el.jsx)(eA,{addon:t,avatar:g,loading:s,onClick:r,placement:u,size:N?32:void 0});return(null==b||null===(n=b.avatarRender)||void 0===n?void 0:n.call(b,e,a))||a},[g,u,N,s]),P=(0,q.useMemo)(function(){if((null==b?void 0:b.contentRender)===!1)return null;var n,t=f?M?M(f):(0,el.jsx)(eP,{message:D,placement:u}):(0,el.jsx)(eG,{editing:v,message:l,className:"".concat(A,"-list-item-message-content"),messageExtra:Z,onChange:x,onDoubleClick:j,onEditingChange:y,placement:u,primary:i,renderMessage:C,text:k,type:p,markdownProps:w});return(null==b||null===(n=b.contentRender)||void 0===n?void 0:n.call(b,e,t))||t},[f,l,Z,C,u,i,k,p,v,D,S]),B=(0,q.useMemo)(function(){if((null==b?void 0:b.actionsRender)===!1||f)return null;var n,t=(0,el.jsx)(eZ,{actions:a,className:"".concat(E(z.actions,"".concat(A,"-list-item-actions")))});return(null==b||null===(n=b.actionsRender)||void 0===n?void 0:n.call(b,e,t))||t},[a]),H=(0,q.useMemo)(function(){if((null==b?void 0:b.titleRender)===!1)return null;var n,t=(0,el.jsx)(eJ,{className:"".concat(E(z.name,"".concat(A,"-list-item-title"))),avatar:g,placement:u,showTitle:h,time:m});return(null==b||null===(n=b.titleRender)||void 0===n?void 0:n.call(b,e,t))||t},[m,g]);if((null==b?void 0:b.render)===!1)return null;var F=(0,el.jsxs)(eh.D,(0,$.Z)((0,$.Z)({className:E(z.container,"".concat(A,"-list-item"),"".concat(A,"-list-item-").concat(u),o),direction:"left"===u?"horizontal":"horizontal-reverse",gap:N?6:12},T),{},{children:[I,(0,el.jsxs)(eh.D,{align:"left"===u?"flex-start":"flex-end",className:E(z.messageContainer,"".concat(A,"-list-item-message-container")),children:[H,(0,el.jsxs)(eh.D,{align:"left"===u?"flex-start":"flex-end",className:E(z.messageContent,"".concat(A,"-message-content")),direction:"block"===p?"left"===u?"horizontal":"horizontal-reverse":"vertical",gap:8,children:[P,B]})]}),N&&"block"===p&&(0,el.jsx)(eD,{borderSpacing:32})]}));return(null==b||null===(n=b.render)||void 0===n?void 0:n.call(b,e,{avatar:I,messageContent:P,actions:B,title:H,itemDom:F},F))||F}),e1=t(74902),e2=function(e){var n=(0,q.useRef)(null);return n.current=e,(0,q.useCallback)(function(){for(var e,t=arguments.length,r=Array(t),a=0;a<t;a++)r[a]=arguments[a];return null===(e=n.current)||void 0===e?void 0:e.call.apply(e,[n].concat((0,e1.Z)(r)))},[])},e4=(0,J.kc)(function(e,n){var t,r,a=e.css,o=e.token,i=e.isDarkMode,s=n.offset,l=n.outside,c=n.size,u=(null!==(t=null==s?void 0:s.x)&&void 0!==t?t:0)+"px",d=(null!==(r=null==s?void 0:s.y)&&void 0!==r?r:0)+"px";return a(D||(D=(0,er.Z)(["\n      pointer-events: none;\n\n      position: absolute;\n      z-index: 1;\n      inset: 0;\n\n      opacity: ",";\n      background: radial-gradient(\n        "," circle at "," ",",\n        ",",\n        ","\n      );\n      border-radius: inherit;\n\n      transition: all 0.2s;\n    "])),l?"0":".1",c+"px",u,d,i?o.colorText:"#fff",i?"transparent":o.colorTextQuaternary)}),e3=["className","size"],e6=function(){var e=(0,q.useState)(),n=(0,et.Z)(e,2),t=n[0],r=n[1],a=(0,q.useState)(!0),o=(0,et.Z)(a,2),i=o[0],s=o[1],l=(0,q.useRef)();return(0,q.useEffect)(function(){if(l.current&&l.current.parentElement){var e=l.current.parentElement,n=function(n){var t=e.getBoundingClientRect();r({x:n.clientX-t.x,y:n.clientY-t.y}),s(!1)},t=function(){s(!0)};return e.addEventListener("mousemove",n),e.addEventListener("mouseleave",t),function(){e.removeEventListener("mousemove",n),e.removeEventListener("mouseleave",t)}}},[]),[t,i,l]},e8=(0,q.memo)(function(e){var n=e.className,t=e.size,r=(0,ee.Z)(e,e3),a=e6(),o=(0,et.Z)(a,3),i=o[0],s=o[1],l=o[2],c=e4({offset:i,outside:s,size:void 0===t?64:t}),u=c.styles,d=c.cx;return(0,el.jsx)("div",(0,$.Z)({className:d(u,n),ref:l},r))}),e5=t(67148),e9=(0,J.kc)(function(e,n){var t=e.css,r=e.stylish;return{block:(0,e.cx)(n.glass&&r.blur,t(I||(I=(0,er.Z)(["\n          cursor: pointer;\n\n          position: relative;\n\n          display: flex;\n          flex: none;\n          align-items: center;\n          justify-content: center;\n        "]))))}}),e7=["color","fill","className","active","icon","size","style","glass","spotlight","onClick","children","loading","title","placement","arrow","tooltipDelay"],ne=function(e){var n,t;switch(e){case"large":n=44,t=8;break;case"normal":n=36,t=5;break;case"small":n=24,t=5;break;case"site":n=34,t=5;break;default:n=(null==e?void 0:e.blockSize)||36,t=(null==e?void 0:e.borderRadius)||5}return{blockSize:n,borderRadius:t}},nn=(0,q.forwardRef)(function(e,n){var t=e.color,r=e.fill,a=e.className,o=e.active,i=e.icon,s=e.size,l=void 0===s?"normal":s,c=e.style,u=e.glass,d=e.spotlight,p=e.onClick,g=e.children,f=e.loading,h=e.title,m=e.placement,v=e.arrow,x=e.tooltipDelay,y=(0,ee.Z)(e,e7),Z=e9({active:!!o,glass:!!u}),C=Z.styles,k=Z.cx,b=(0,q.useMemo)(function(){return ne(l)},[l]),M=b.blockSize,w=b.borderRadius,j=(0,el.jsxs)(el.Fragment,{children:[i&&(0,el.jsx)(ed,{color:t,fill:r,icon:i,size:"site"===l?"normal":l}),g]}),S=(0,el.jsx)(ed,{color:t,icon:eE.Z,size:"site"===l?"normal":l,spin:!0}),T=(0,el.jsxs)("div",(0,$.Z)((0,$.Z)({className:k(C.block,a),onClick:f?void 0:p,ref:n,style:(0,$.Z)({borderRadius:w,height:M,width:M},c)},y),{},{children:[d&&(0,el.jsx)(e8,{}),f?S:j]}));return(0,el.jsx)(el.Fragment,{children:(0,el.jsx)(e5.Z,(0,$.Z)((0,$.Z)({},y),{},{arrow:void 0!==v&&v,tooltipDelay:void 0===x?.5:x,placement:m,title:h,icon:T,size:M}))})}),nt=t(33589),nr=(0,q.memo)(function(e){var n=e.type,t=e.items,r=void 0===t?[]:t,a=e.placement,o=e.spotlight,i=void 0!==o&&o,s=e.direction,l=void 0===s?"row":s,c=e.dropdownMenu,u=void 0===c?null:c,d=e.onActionClick,p=e.className,g=e.style,f=a||("column"===l?"right":"top"),h=null==u?void 0:u.map(function(e){return(0,$.Z)((0,$.Z)({},e),{},{icon:(0,el.jsx)(ed,{icon:e.icon,size:"small"}),onClick:d?function(n){return d({item:e,key:n.key,keyPath:n.keyPath})}:void 0})});return(0,el.jsx)(nt.W,{className:p,direction:l,type:void 0===n?"block":n,dropdownProps:{placement:f},style:g,dropdownMenu:h,render:function(){return(0,el.jsxs)(el.Fragment,{children:[i&&(0,el.jsx)(e8,{}),(null==r?void 0:r.length)>0&&r.map(function(e){return(0,el.jsx)(nn,{icon:e.icon,onClick:d?function(){return null==d?void 0:d({item:e,key:e.key,keyPath:[e.key]})}:void 0,placement:f,size:"small",title:e.label},e.key)})]})}})}),na=t(76915),no=t(96895),ni=t(62888),ns=t(13671),nl=["text"],nc=(0,q.memo)(function(e){var n=e.text,t=(0,ee.Z)(e,nl),r={copy:{icon:na.Z,key:"copy",label:(null==n?void 0:n.copy)||"Copy"},del:{icon:ns.Z,key:"del",label:(null==n?void 0:n.delete)||"Delete"},divider:{type:"divider"},edit:{icon:no.Z,key:"edit",label:(null==n?void 0:n.edit)||"Edit"},regenerate:{icon:ni.Z,key:"regenerate",label:(null==n?void 0:n.regenerate)||"Regenerate"}},a=r.regenerate,o=r.edit,i=r.copy,s=r.divider,l=r.del;return(0,el.jsx)(nr,(0,$.Z)({dropdownMenu:[o,i,a,s,l],items:[a,o],type:"ghost"},t))}),nu=["renderMessagesExtra","showTitle","onActionsClick","onMessageChange","originData","type","text","renderMessages","renderErrorMessages","renderActions","loading","groupNav","renderItems","chatItemRenderConfig","chatItemClassName","markdownProps"],nd=function(e){var n=e.renderMessagesExtra,t=e.showTitle,r=e.onActionsClick,a=e.onMessageChange,o=e.originData,i=e.type,s=e.text,l=e.renderMessages,c=e.renderErrorMessages,u=e.renderActions,d=e.loading,p=e.groupNav,g=e.renderItems,f=e.chatItemRenderConfig,h=e.chatItemClassName,m=e.markdownProps,v=(0,ee.Z)(e,nu),x=(0,q.useState)(!1),y=(0,et.Z)(x,2),Z=y[0],C=y[1],k=en.Z.useApp().message,b=(0,q.useMemo)(function(){var e;if(g&&null!=v&&v.role&&(null!=g&&g[v.role]&&(e=g[v.role]),!e&&null!=g&&g.default&&(e=g.default),e))return e},[null==g?void 0:g[v.role]]),M=e2(function(e){var n,t=e.editableContent,r=e.data;if(l&&null!=v&&v.role&&(null!=l&&l[v.role]&&(n=l[v.role]),!n&&null!=l&&l.default&&(n=l.default),n))return(0,el.jsx)(n,(0,$.Z)((0,$.Z)({},r),{},{editableContent:t}))}),w=e2(function(e){var t,r=e.data;if(n&&null!=v&&v.role&&(null!=n&&n[v.role]&&(t=n[v.role]),null!=n&&n.default&&(t=n.default),t||t))return(0,el.jsx)(t,(0,$.Z)({},r))}),j=e2(function(e){var n,t=e.data;if(u&&null!=v&&v.role){null!=u&&u[v.role]&&(n=u[v.role]),null!=u&&u.default&&(n=u.default),n||(n=nc);var a=function(e,n){switch(e.key){case"copy":ex()(n.content),k.success((null==s?void 0:s.copySuccess)||"Copy Success");break;case"edit":C(!0)}null==r||r(e,n)};return(0,el.jsx)(n,(0,$.Z)((0,$.Z)({},t),{},{onActionClick:function(e){return null==a?void 0:a(e,t)},text:s}))}}),S=(0,q.useMemo)(function(){if(v.error)return v.error},[v.error]),T=(0,q.useMemo)(function(){return(0,el.jsx)(e0,{className:h,"data-id":v.id,actions:(0,el.jsx)(j,{data:v}),avatar:v.meta,avatarAddon:p,editing:Z,originData:o,error:S,renderErrorMessages:c,loading:d,message:v.content,messageExtra:(0,el.jsx)(w,{data:v}),onChange:function(e){return null==a?void 0:a(v.id,e)},onDoubleClick:function(e){"default"!==v.id&&!v.error&&v.role&&["assistant","user"].includes(v.role)&&e.altKey&&C(!0)},onEditingChange:C,placement:"chat"===i&&"user"===v.role?"right":"left",primary:"user"===v.role,renderMessage:function(e){return(0,el.jsx)(M,{data:v,editableContent:e})},showTitle:t,text:s,time:v.updateAt||v.createAt,type:"chat"===i?"block":"pure",chatItemRenderConfig:f,markdownProps:m})},[e.content,e.loading,e.id,v.meta,v.error,v.updateAt||v.createAt,Z]);return b?(0,el.jsx)(b,(0,$.Z)({},e),v.id):T},np=t(74253),ng=t(43777),nf=t(59361),nh=["icon","children","size"],nm=(0,J.kc)(function(e){var n=e.cx,t=e.css,r=e.token;return{small:t(P||(P=(0,er.Z)(["\n    padding: 2px 6px;\n    line-height: 1;\n  "]))),tag:n(t(B||(B=(0,er.Z)(["\n    color: "," !important;\n    background: ",";\n    border: ","px;\n\n    &:hover {\n      color: ",";\n      background: ",";\n    }\n  "])),r.colorTextSecondary,r.colorFillSecondary,r.borderRadius,r.colorText,r.colorFill))}}),nv=(0,q.memo)(function(e){var n=e.icon,t=e.children,r=e.size,a=void 0===r?"default":r,o=(0,ee.Z)(e,nh),i=nm(),s=i.styles,l=i.cx;return(0,el.jsx)(nf.Z,(0,$.Z)((0,$.Z)({bordered:!1,className:l(s.tag,"small"===a&&s.small)},o),{},{children:(0,el.jsxs)(eh.D,{align:"center",gap:4,horizontal:!0,children:[n,t]})}))}),nx=(0,q.memo)(function(e){var n=e.enable,t=e.text;return n?(0,el.jsx)("div",{style:{padding:"0 20px"},children:(0,el.jsx)(np.Z,{children:(0,el.jsx)(nv,{icon:(0,el.jsx)(ed,{icon:ng.Z}),children:t||"History Message"})})}):null}),ny=t(15671),nZ=t(43144),nC=t(60136),nk=t(29388),nb=t(64063),nM=t.n(nb),nw=function(e){(0,nC.Z)(t,e);var n=(0,nk.Z)(t);function t(){return(0,ny.Z)(this,t),n.apply(this,arguments)}return(0,nZ.Z)(t,[{key:"shouldComponentUpdate",value:function(e){if(e.shouldUpdate)return e.shouldUpdate(this.props,e);try{return!nM()(this.props.content,null==e?void 0:e.content)||!nM()(this.props.loading,null==e?void 0:e.loading)||!nM()(this.props.chatItemRenderConfig,null==e?void 0:e.chatItemRenderConfig)||!nM()(this.props.meta,null==e?void 0:e.meta)}catch(e){return!0}}},{key:"render",value:function(){return this.props.children}}]),t}(q.Component),nj=(0,J.kc)(function(e){return{container:(0,e.css)(H||(H=(0,er.Z)(["\n      position: relative;\n    "])))}}),nS=["onActionsClick","renderMessagesExtra","className","data","type","text","showTitle","itemShouldUpdate","onMessageChange","renderMessages","renderErrorMessages","loadingId","renderItems","enableHistoryCount","renderActions","historyCount","chatItemRenderConfig","markdownProps"],nT=(0,q.memo)(function(e){var n=e.onActionsClick,t=e.renderMessagesExtra,r=e.className,a=e.data,o=e.type,i=void 0===o?"chat":o,s=e.text,l=e.showTitle,c=e.itemShouldUpdate,u=e.onMessageChange,d=e.renderMessages,p=e.renderErrorMessages,g=e.loadingId,f=e.renderItems,h=e.enableHistoryCount,m=e.renderActions,v=e.historyCount,x=void 0===v?0:v,y=e.chatItemRenderConfig,Z=e.markdownProps,C=(0,ee.Z)(e,nS),k=nj(),b=k.cx,M=k.styles,w=(0,(0,q.useContext)(em.default.ConfigContext).getPrefixCls)("pro-chat");return(0,el.jsx)("div",(0,$.Z)((0,$.Z)({className:b(M.container,"".concat(w,"-list"),r)},C),{},{children:a.map(function(e,r){var o={loading:g===e.id,onActionsClick:n,onMessageChange:u,renderActions:m,renderErrorMessages:p,renderItems:f,renderMessages:d,renderMessagesExtra:t,showTitle:l,text:s,type:i},v=a.length;return(0,el.jsx)(nw,(0,$.Z)((0,$.Z)((0,$.Z)({},o),e),{},{shouldUpdate:c,children:(0,el.jsxs)(q.Fragment,{children:[(0,el.jsx)(nx,{enable:h&&v>x&&x===v-r+1,text:null==s?void 0:s.history}),(0,el.jsx)(nd,(0,$.Z)((0,$.Z)((0,$.Z)({},o),e),{},{originData:e,chatItemRenderConfig:y,markdownProps:Z}))]})}),e.id)})}))}),nN=(0,t(33869).k)(),nR=nN.useStore,nE=nN.useStoreApi,nz=nN.Provider,nA=t(29144),nD={placeholder:"Please enter a message...",backToBottom:"Back to bottom",clearCurrentDialogue:"Clear current dialogue",clearDialogue:"Clear dialogue",clearModalTitle:"You are about to clear the session, and you will not be able to retrieve it after clearing. Do you want to clear the current session?",defaultHelloMessage:"Let us start chatting",cancel:"Cancel",confirm:"Confirm",copy:"Copy",copySuccess:"Copy Success",delete:"Delete",edit:"Edit",history:"History",regenerate:"Regenerate"},nI={"en-US":nD,"zh-CN":{placeholder:"Nhập c\xe2u hỏi",backToBottom:"Quay lại",clearCurrentDialogue:"Xo\xe1 cuộc tr\xf2 chuyện hiện tại",clearDialogue:"Xo\xe1 to\xe0n bộ cuộc tr\xf2 chuyện",clearModalTitle:"Bạn sắp x\xf3a phi\xean của m\xecnh. Sau khi x\xf3a, bạn sẽ kh\xf4ng thể truy xuất phi\xean đ\xf3. X\xf3a phi\xean hiện tại?",defaultHelloMessage:"Xin ch\xe0o!",cancel:"Huỷ",confirm:"X\xe1c nhận",copy:"Copy",copySuccess:"Copy th\xe0nh c\xf4ng",delete:"Xo\xe1",edit:"Sửa",history:"Lịch sử",regenerate:"T\xe1i tạo"},"zh-HK":{placeholder:"請輸入訊息...",backToBottom:"回到底部",clearCurrentDialogue:"清除當前對話",clearDialogue:"清除對話",clearModalTitle:"您即將清除會話，清除後將無法恢復。您確定要清除當前會話嗎？",defaultHelloMessage:"讓我們開始聊天吧",cancel:"取消",confirm:"確認",copy:"複製",copySuccess:"複製成功",delete:"刪除",edit:"編輯",history:"歷史",regenerate:"重新生成"},en:nD},nP=function(e){return nI[e]||nI["en-US"]},nB=function(e,n){return n.enableHistoryCount&&n.historyCount?e.reverse().slice(0,n.historyCount).reverse():e},nH=["avatar","title","backgroundColor"],nF=function(e){if(0===Object.keys(e.chats).length)return[];var n,t=function(n){var t=e.userMeta,r=t.avatar,a=t.title,o=(t.backgroundColor,(0,ee.Z)(t,nH)),i=e.assistantMeta;switch(null==n?void 0:n.role){case"user":return(0,$.Z)({avatar:r,title:a},o);case"system":return i;case"assistant":return{avatar:null==i?void 0:i.avatar,backgroundColor:null==i?void 0:i.backgroundColor,title:null==i?void 0:i.title}}return(0,$.Z)({},n)},r=e.chats.map(function(e){return(0,$.Z)((0,$.Z)({},e),{},{meta:t(e)})}),a=[],o=function(e){a.findIndex(function(n){return e.id===n.id})>-1||a.push(e)},i=(0,nA.Z)(r);try{for(i.s();!(n=i.n()).done;){var s=n.value;o(s);var l,c=(0,nA.Z)(r);try{for(c.s();!(l=c.n()).done;){var u=l.value;u.parentId===s.id&&o(u)}}catch(e){c.e(e)}finally{c.f()}}}catch(e){i.e(e)}finally{i.f()}return a},nO=function(e){return nB(nF(e),e.config)},nL={chatsMessageString:function(e){return nO(e).map(function(e){return e.content}).join("")},currentChats:nF,currentChatsWithGuideMessage:function(e){var n,t=nF(e);return 0!==t.length?t:[(0,$.Z)({content:null!==(n=e.helloMessage)&&void 0!==n?n:nP(e.locale).defaultHelloMessage,createAt:Date.now(),extra:{},id:"default",meta:e.assistantMeta,role:"hello",updateAt:Date.now()},t)]},currentChatsWithHistoryConfig:nO},n_=function(){var e=nR(function(e){return e.locale}),n=(0,q.useMemo)(function(){return nP(e)},[e]);return{locale:e,localeObject:n}},nU=["extra"],nW=(0,q.memo)(function(e){var n=e.extra,t=(0,ee.Z)(e,nU),r=nR(function(e){return[e.config.model,e.messageItemExtraRender]}),a=(0,et.Z)(r,2),o=a[0],i=a[1],s=(null==n?void 0:n.fromModel)&&o!==(null==n?void 0:n.fromModel),l=!!(null!=n&&n.translate),c=null==i?void 0:i((0,$.Z)({extra:n},t),"assistant");if(s||l||c)return(0,el.jsxs)(eh.D,{gap:8,style:{marginTop:8},children:[s&&(0,el.jsx)("div",{children:(0,el.jsx)(nv,{children:null==n?void 0:n.fromModel})}),c]})}),nQ=["extra"],nV={assistant:nW,user:(0,q.memo)(function(e){var n=e.extra,t=(0,ee.Z)(e,nQ),r=!!(null!=n&&n.translate),a=nR(function(e){return[e.messageItemExtraRender]}),o=(0,et.Z)(a,1)[0],i=null==o?void 0:o((0,$.Z)({extra:n},t),"user");if(i)return(0,el.jsxs)(eh.D,{gap:8,style:{marginTop:r?8:0},children:[(null==n?void 0:n.translate)&&(0,el.jsx)("div",{children:(0,el.jsx)(np.Z,{style:{margin:"12px 0"}})}),i]})})},nX=function(){return(0,el.jsxs)("svg",{viewBox:"0 0 32 24",xmlns:"http://www.w3.org/2000/svg",children:[(0,el.jsx)("circle",{cx:"0",cy:"12",r:"0",transform:"translate(8 0)",children:(0,el.jsx)("animate",{attributeName:"r",begin:"0",calcMode:"spline",dur:"1.2s",keySplines:"0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8;0.2 0.6 0.4 0.8",keyTimes:"0;0.2;0.7;1",repeatCount:"indefinite",values:"0; 4; 0; 0"})}),(0,el.jsx)("circle",{cx:"0",cy:"12",r:"0",transform:"translate(16 0)",children:(0,el.jsx)("animate",{attributeName:"r",begin:"0.3",calcMode:"spline",dur:"1.2s",keySplines:"0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8;0.2 0.6 0.4 0.8",keyTimes:"0;0.2;0.7;1",repeatCount:"indefinite",values:"0; 4; 0; 0"})}),(0,el.jsx)("circle",{cx:"0",cy:"12",r:"0",transform:"translate(24 0)",children:(0,el.jsx)("animate",{attributeName:"r",begin:"0.6",calcMode:"spline",dur:"1.2s",keySplines:"0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8;0.2 0.6 0.4 0.8",keyTimes:"0;0.2;0.7;1",repeatCount:"indefinite",values:"0; 4; 0; 0"})})]})},nG=function(){var e=(0,J.Fg)().colorTextTertiary;return(0,el.jsx)("div",{style:{fill:e,height:24,width:32},children:(0,el.jsx)(nX,{})})},nY=(0,q.memo)(function(e){var n=e.id,t=e.editableContent;return"..."===e.content?(0,el.jsx)(nG,{}):(0,el.jsx)("div",{id:n,children:t})}),nq=["id","content"],nK=(0,q.memo)(function(e){var n=e.id,t=e.content,r=(0,ee.Z)(e,nq);return(0,el.jsx)(nY,(0,$.Z)({content:t,id:n},r))}),nJ={hello:(0,q.memo)(function(e){var n=e.content;return"string"==typeof n?(0,el.jsx)(nY,(0,$.Z)({},e)):n}),assistant:nK,default:nY},n$=t(10149),n0=(0,J.kc)(function(e){var n=e.css,t=e.prefixCls;return{user:n(F||(F=(0,er.Z)(["\n    display: flex;\n    flex-direction: row-reverse;\n    gap: 16px;\n\n    .","-skeleton-paragraph {\n      display: flex;\n      flex-direction: column;\n      align-items: flex-end;\n    }\n  "])),t)}}),n1=(0,q.memo)(function(){var e=n0().styles;return(0,el.jsxs)(eh.D,{gap:24,padding:12,style:{marginTop:24},children:[(0,el.jsx)(n$.default,{active:!0,avatar:{size:40},className:e.user,paragraph:{width:["50%","30%"]},title:!1}),(0,el.jsx)(n$.default,{active:!0,avatar:{size:40},paragraph:{width:["50%","30%"]},title:!1})]})}),n2=(0,q.memo)(function(e){var n=e.showTitle,t=e.itemShouldUpdate,r=e.chatItemRenderConfig,a=e.renderErrorMessages,o=e.markdownProps,i=nR(nL.currentChatsWithGuideMessage,nM()),s=n_().localeObject,l=nR(function(e){return e.locale}),c=nR(function(e){var n=e.config;return[e.init,e.displayMode,n.enableHistoryCount,n.historyCount,e.chatLoadingId,e.deleteMessage,e.resendMessage,e.dispatchMessage]}),u=(0,et.Z)(c,8),d=u[0],p=u[1],g=u[2],f=u[3],h=u[4],m=u[5],v=u[6],x=u[7],y=e2(function(e,n){var t=n.id,r=n.error;switch(e.key){case"del":m(t);break;case"regenerate":v(t),r&&m(t)}}),Z=e2(function(e,n){return x({id:e,key:"content",type:"updateMessage",value:n})}),C=(0,q.useMemo)(function(){return{cancel:s.cancel,confirm:s.confirm,copy:s.copy,copySuccess:s.copySuccess,delete:s.delete,edit:s.edit,history:s.history,regenerate:s.regenerate}},[l]);return d?(0,el.jsx)(nT,{showTitle:n,data:i,itemShouldUpdate:t,enableHistoryCount:g,historyCount:f,loadingId:h,onActionsClick:y,onMessageChange:Z,renderMessages:nJ,renderErrorMessages:a,renderMessagesExtra:nV,style:{marginTop:24},chatItemRenderConfig:r,text:C,type:p||"chat",markdownProps:o}):(0,el.jsx)(n1,{})}),n4=t(74165),n3=t(15861),n6=t(88482),n8=t(35297),n5=t(13718),n9=(0,J.kc)(function(e){var n=e.css,t=e.token;return{extra:n(O||(O=(0,er.Z)(["\n    color: ",";\n  "])),t.colorTextTertiary)}}),n7=function(e){var n,t=e.className,r=nR(function(e){var n,t;return[e.clearMessage,null===(n=e.actions)||void 0===n?void 0:n.render,null===(t=e.actions)||void 0===t?void 0:t.flexConfig]}),a=(0,et.Z)(r,3),o=(a[0],a[1]),i=a[2],s=n_().localeObject,l=n9(),c=l.styles,u=l.theme;return n8.Z,s.clearModalTitle,s.clearDialogue,s.cancel,s.clearCurrentDialogue,n5.Z,(0,el.jsx)(em.default,{theme:{token:{colorText:u.colorTextSecondary}},children:(0,el.jsx)(eh.D,(0,$.Z)((0,$.Z)({align:"center",direction:"horizontal-reverse",paddingInline:12,className:(0,J.cx)(c.extra,t),gap:8},i),{},{children:null!==(n=null==o?void 0:o(null))&&void 0!==n?n:null}))})},te=t(17669),tn=["disabled","autoCompleteProps"],tt=q.forwardRef(function(e,n){var t,r=nR(function(e){return[e.autocompleteRequest]}),a=(0,et.Z)(r,1)[0],o=e.disabled,i=e.autoCompleteProps,s=void 0===i?{}:i,l=(0,ee.Z)(e,tn),c=(0,q.useState)([]),u=(0,et.Z)(c,2),d=u[0],p=u[1],g=(0,q.useState)(!1),f=(0,et.Z)(g,2),h=f[0],m=f[1];return(0,el.jsx)(te.Z,(0,$.Z)((0,$.Z)({className:e.className,options:d,style:{height:"max-content"},disabled:o,open:h,onDropdownVisibleChange:function(e){m(e)},value:e.value,onSelect:function(n){var t;null===(t=e.onChange)||void 0===t||t.call(e,{target:{value:n}}),p([])},onSearch:(t=(0,n3.Z)((0,n4.Z)().mark(function e(n){return(0,n4.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==a?void 0:a(n);case 2:p(e.sent||[]);case 4:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)})},s),{},{children:(0,el.jsx)(Y.default.TextArea,(0,$.Z)((0,$.Z)({size:"large"},l),{},{ref:n,disabled:o,className:"".concat(e.className,"-textarea"),onFocus:function(n){var t;m(!1),null===(t=e.onFocus)||void 0===t||t.call(e,n)},onPressEnter:function(n){var t;h&&d.length>0||null===(t=e.onPressEnter)||void 0===t||t.call(e,n)}}))}))}),tr=(0,q.memo)(function(){var e=(0,J.Fg)();return(0,el.jsx)("svg",{className:"anticon",color:"currentColor",height:16,viewBox:"0 0 1024 1024",width:16,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",children:(0,el.jsxs)("g",{fill:"none",children:[(0,el.jsx)("circle",{cx:"512",cy:"512",fill:"none",r:"426",stroke:e.colorBorder,strokeWidth:"72"}),(0,el.jsx)("rect",{fill:"currentColor",height:"252",rx:"24",ry:"24",width:"252",x:"386",y:"386"}),(0,el.jsx)("path",{d:"M938.667 512C938.667 276.359 747.64 85.333 512 85.333",stroke:"currentColor",strokeLinecap:"round",strokeWidth:"73",children:(0,el.jsx)("animateTransform",{attributeName:"transform",dur:"1s",from:"0 512 512",repeatCount:"indefinite",to:"360 512 512",type:"rotate"})})]})})}),ta=(0,J.kc)(function(e){var n=e.css,t=e.responsive,r=e.token;return{container:n(L||(L=(0,er.Z)(["\n    position: sticky;\n    z-index: ",";\n    bottom: 0;\n\n    padding-top: 12px;\n    padding-bottom: 24px;\n\n    background-image: linear-gradient(to top, "," 88%, transparent 100%);\n\n    "," {\n      width: 100%;\n    }\n  "])),r.zIndexPopupBase,r.colorBgLayout,t.mobile),boxShadow:n(_||(_=(0,er.Z)(["\n    position: relative;\n    border-radius: 8px;\n    box-shadow: ",";\n  "])),r.boxShadowSecondary),input:n(U||(U=(0,er.Z)(["\n    width: 100%;\n    border: none;\n    outline: none;\n    border-radius: 8px;\n  "]))),btn:n(W||(W=(0,er.Z)(["\n    position: absolute;\n    z-index: 10;\n    right: 8px;\n    bottom: 6px;\n\n    color: ",";\n    &:hover {\n      color: ",";\n    }\n  "])),r.colorTextTertiary,r.colorTextSecondary),extra:n(Q||(Q=(0,er.Z)(["\n    color: ",";\n  "])),r.colorTextTertiary)}}),to=function(e){var n,t=e||{},r=t.className,a=t.onSend,o=t.inputAreaRender,i=t.inputRender,s=t.sendButtonRender,l=nR(function(e){return[e.sendMessage,!!e.chatLoadingId,e.placeholder,e.inputAreaProps,e.clearMessage,e.stopGenerateMessage]}),c=(0,et.Z)(l,6),u=c[0],d=c[1],p=c[2],g=c[3],f=c[4],h=c[5],m=(0,q.useContext)(em.default.ConfigContext).getPrefixCls,v=(0,q.useRef)(!1),x=ta(),y=x.styles,Z=x.theme,C=n_().localeObject,k=g||{},b=k.value,M=k.onChange,w=(0,q.useState)(""),j=(0,et.Z)(w,2),S=j[0],T=j[1];(0,q.useEffect)(function(){!v.current&&M&&M(S)},[S]),(0,q.useEffect)(function(){b&&T(b)},[b]);var N=(n=(0,n3.Z)((0,n4.Z)().mark(function e(){return(0,n4.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=7;break}return e.next=3,a(S);case 3:e.sent&&(u(S),T("")),e.next=9;break;case 7:u(S),T("");case 9:case"end":return e.stop()}},e)})),function(){return n.apply(this,arguments)}),R=m("pro-chat-input-area"),E=(0,$.Z)((0,$.Z)({placeholder:p||C.placeholder},g),{},{className:(0,J.cx)(y.input,null==g?void 0:g.className,"".concat(R,"-component")),value:S,onChange:function(e){T(e.target.value)},autoSize:{maxRows:8},onCompositionStart:function(){v.current=!0},onCompositionEnd:function(e){v.current=!1,T(e.target.value)},onPressEnter:function(e){d||e.shiftKey||v.current||(e.preventDefault(),N())}}),z=(0,el.jsx)(tt,(0,$.Z)({},E)),A=i?null==i?void 0:i(z,function(e){u(e)},E):z,D=(0,q.useMemo)(function(){return d?{type:"text",className:y.btn,onClick:function(){return h()},icon:(0,el.jsx)(tr,{})}:{type:"text",className:y.btn,onClick:function(){return N()},icon:(0,el.jsx)(n6.default,{})}},[d,S]),I=(0,el.jsx)(eo(),(0,$.Z)({},D)),P=s?s(I,D):I,B=(0,el.jsx)(em.default,{theme:{token:{borderRadius:4,colorBgContainer:Z.colorBgElevated,controlHeightLG:48,colorBorder:"transparent",colorPrimaryHover:"transparent"}},children:(0,el.jsxs)(eh.D,{gap:8,padding:16,className:(0,J.cx)(y.container,"".concat(R),r),children:[(0,el.jsx)(n7,{className:"".concat(R,"-action-bar")}),(0,el.jsxs)(eh.D,{horizontal:!0,gap:8,align:"center",className:(0,J.cx)(y.boxShadow,"".concat(R,"-text-container")),children:[A,P]})]})});return o?o(B,function(e){u(e)},f):B},ti=t(56623),ts=(0,q.memo)(function(e){var n=e.target,t=nR(function(e){return!!e.chatLoadingId}),r=nR(nL.currentChats),a=(0,q.useState)(!1),o=(0,et.Z)(a,2),i=o[0],s=o[1];(0,q.useEffect)(function(){s(!0)},[]);var l=(0,q.useMemo)(function(){return n.current?n.current:document.body},[i]),c=(0,q.useState)(0),u=(0,et.Z)(c,2),d=u[0],p=u[1];(0,q.useEffect)(function(){i&&p(window.innerHeight/3>100?100:window.innerHeight/4)},[i]);var g=(0,ti.YD)({root:n.current,delay:100,rootMargin:"0px 0px ".concat(d,"px 0px"),trackVisibility:t}),f=g.ref,h=g.entry,m=g.inView;return(0,q.useEffect)(function(){t&&m&&(null==l||l.scrollTo({behavior:"smooth",left:0,top:(null==l?void 0:l.scrollHeight)||99999}))},[m,h,t,r]),(0,el.jsx)("div",{ref:f,style:{height:1,width:"100%"}})}),tl=(0,J.kc)(function(e){var n=e.token,t=e.prefixCls,r=e.cx,a="".concat(t,"-pro-chat");return{container:r(a,(0,J.iv)(V||(V=(0,er.Z)(["\n    line-height: 1;\n    text-size-adjust: none;\n    text-rendering: optimizelegibility;\n    vertical-align: baseline;\n\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    -webkit-overflow-scrolling: touch;\n    -webkit-tap-highlight-color: transparent;\n  }\n\n  ."," {\n    code {\n      font-family: "," !important;\n\n      span {\n        font-family: "," !important;\n      }\n    }\n\n    p {\n      word-wrap: break-word;\n    }\n\n    *::selection {\n      color: #000;\n      background: ",";\n\n      -webkit-text-fill-color: unset !important;\n    }\n\n    * {\n      box-sizing: border-box;\n      vertical-align: baseline;\n    }\n  }\n"])),a,n.fontFamilyCode,n.fontFamilyCode,n.blue3))}}),tc=(0,J.kc)(function(e){var n=e.css,t=e.responsive,r=e.stylish;return n(X||(X=(0,er.Z)(["\n    overflow: hidden scroll;\n    height: 100%;\n    "," {\n      ","\n      width: 100%;\n    }\n  "])),t.mobile,r.noScrollbar)}),tu=(0,q.memo)(function(e){var n,t=e.renderInputArea,r=e.inputAreaRender,a=e.className,o=e.style,i=e.showTitle,s=e.chatRef,l=e.itemShouldUpdate,c=e.inputRender,u=e.chatItemRenderConfig,d=e.backToBottomConfig,p=e.renderErrorMessages,g=e.sendButtonRender,f=e.onScroll,h=e.markdownProps,m=(0,q.useRef)(null),v=(0,q.useRef)(null),x=tc(),y=x.styles,Z=x.cx,C=tl().styles,k=(0,q.useState)(!1),b=(0,et.Z)(k,2),M=b[0],w=b[1],j=(0,q.useState)("100%"),S=(0,et.Z)(j,2),T=S[0],N=S[1],R=(0,q.useContext)(em.default.ConfigContext).getPrefixCls,E=n_().localeObject;(0,q.useEffect)(function(){w(!0),null!=s&&s.current&&(s.current.scrollToBottom=function(){var e,n;null==m||null===(e=m.current)||void 0===e||e.scrollTo({behavior:"smooth",left:0,top:(null===(n=m.current)||void 0===n?void 0:n.scrollHeight)||99999})})},[]);var z=R("pro-chat");return(0,el.jsx)(ef.default,{onResize:function(e){e.height!==T&&N(e.height)},children:(0,el.jsxs)(eh.D,{className:Z(C.container,a,"".concat(z,"-container")),style:(0,$.Z)({maxHeight:"100vh",height:"100%"},o),children:[(0,el.jsxs)(el.Fragment,{children:[(0,el.jsxs)("div",{ref:m,className:Z("".concat(z,"-chat-list-container"),y),style:{height:T-((null===(n=v.current)||void 0===n?void 0:n.clientHeight)||0)||"100%"},children:[(0,el.jsx)(n2,{showTitle:i,itemShouldUpdate:l,chatItemRenderConfig:u,markdownProps:h,renderErrorMessages:p}),(null==m?void 0:m.current)&&(0,el.jsx)(ts,{target:m})]}),M&&null!=m&&m.current?(0,el.jsx)(eg,(0,$.Z)({style:{bottom:138},onScroll:f,target:m,text:E.backToBottom},d)):null]}),null!==t&&null!==r&&(0,el.jsx)("div",{ref:v,children:(0,el.jsx)(to,{sendButtonRender:g,inputAreaRender:r||t,inputRender:c})})]})})}),td=t(43334),tp=function(){var e=nE(),n=e.getState(),t=n.resendMessage,r=n.sendMessage,a=n.stopGenerateMessage,o=n.deleteMessage,i=n.clearMessage,s=n.dispatchMessage,l=n.getChatLoadingId,c=e2(function(){return e.getState().chats}),u=e2(function(e){return s((0,$.Z)((0,$.Z)({},e),{},{type:"addMessage",message:null==e?void 0:e.content}))}),d=e2(function(){return nL.currentChats(e.getState())}),p=e2(function(e,n){s({type:"updateMessage",id:e,key:"content",value:n})}),g=e2(function(e,n,t){s({type:"updateMessage",id:e,key:n,value:t})});return(0,q.useMemo)(function(){return{getChats:c,pushChat:u,getChatMessages:d,resendMessage:t,sendMessage:r,getChatLoadingId:l,stopGenerateMessage:a,deleteMessage:o,clearMessage:i,setMessageContent:p,setMessageValue:g}},[])},tg=(0,q.memo)(function(e){var n=e.init,t=e.onChatsChange,r=e.chatRef,a=e.request,o=e.userMeta,i=e.assistantMeta,s=e.helloMessage,l=e.transformToChatMessage,c=e.actions,u=e.inputAreaProps,d=e.chats,p=e.config,g=e.locale,f=nE(),h=(0,td.N)(f);h("init",n),h("userMeta",o),h("assistantMeta",i),h("inputAreaProps",u),h("helloMessage",s),h("config",p),h("transformToChatMessage",l),h("actions",c),h("chats",d),h("onChatsChange",t),h("request",a),h("locale",g);var m=tp();return(0,q.useImperativeHandle)(r,function(){return m}),null}),tf=t(89169),th=t(96288),tm=t(52464),tv=t(61395),tx=(r=(0,n3.Z)((0,n4.Z)().mark(function e(n){var t;return(0,n4.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={message:"response error, status: ".concat(n.statusText),type:n.status},e.abrupt("return",t);case 2:case"end":return e.stop()}},e)})),function(e){return r.apply(this,arguments)}),ty=(a=(0,n3.Z)((0,n4.Z)().mark(function e(n){var t,r,a,o,i,s,l,c,u,d,p,g,f,h,m=arguments;return(0,n4.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=m.length>1&&void 0!==m[1]?m[1]:{},e.next=3,n();case 3:if((r=e.sent).ok){e.next=10;break}return e.next=7,tx(r);case 7:return o=e.sent,null===(a=t.onErrorHandle)||void 0===a||a.call(t,o),e.abrupt("return");case 10:if(i=r.clone(),s=r.body){e.next=14;break}return e.abrupt("return");case 14:l=s.getReader(),c=new TextDecoder,u=!1;case 17:if(u){e.next=28;break}return e.next=20,l.read();case 20:g=(p=e.sent).value,u=f=p.done,h=c.decode(g,{stream:!f}),null===(d=t.onMessageHandle)||void 0===d||d.call(t,h,i),e.next=17;break;case 28:return e.abrupt("return",i);case 29:case"end":return e.stop()}},e)})),function(e){return a.apply(this,arguments)}),tZ=(0,t(14181).k)("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",8),tC={historyCount:1,model:"gpt-3.5-turbo",params:{frequency_penalty:0,presence_penalty:0,temperature:.6,top_p:1},systemRole:""},tk={chats:[],init:!0,displayMode:"chat",userMeta:{avatar:"https://static.vecteezy.com/system/resources/previews/022/123/337/original/user-icon-profile-icon-account-icon-login-sign-line-vector.jpg"},assistantMeta:{avatar:"https://static.vecteezy.com/system/resources/previews/021/059/827/non_2x/chatgpt-logo-chat-gpt-icon-on-white-background-free-vector.jpg"},config:tC},tb=t(4942),tM=t(29146),tw=function(e,n){switch(n.type){case"addMessage":return(0,tM.Uy)(e,function(e){var t=n.id||tZ();e.push({content:n.message,createAt:Date.now(),id:t,parentId:n.parentId,role:n.role,updateAt:Date.now()})});case"deleteMessage":return e.map(function(e){return e.id!==n.id&&e}).filter(Boolean);case"updateMessage":return(0,tM.Uy)(e,function(e){var t=n.id,r=n.key,a=n.value,o=e.find(function(e){return e.id===t});o&&(o[r]=a,o.updateAt=Date.now())});case"updateMessageExtra":return(0,tM.Uy)(e,function(e){var t=n.id,r=n.key,a=n.value,o=e.find(function(e){return e.id===t});o&&(o.extra?o.extra[r]=a:o.extra=(0,tb.Z)({},r,a),o.updateAt=Date.now())});case"resetMessages":return[];default:throw Error("暂未实现的 type，请检查 reducer")}},tj=function(e,n){var t=["chat/message",e].filter(Boolean).join("/");return n?{payload:n,type:t}:t},tS=function(e,n){var t,r,a,o,i,s;return{clearMessage:((0,n3.Z)((0,n4.Z)().mark(function e(){var t,r,a;return(0,n4.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(t=n()).dispatchMessage,!(a=t.onResetMessage)){e.next=4;break}return e.next=4,a();case 4:r({type:"resetMessages"});case 5:case"end":return e.stop()}},e)})),function(){}),deleteMessage:function(e){},updateMessageContent:(t=(0,n3.Z)((0,n4.Z)().mark(function e(t,r){var a,o,i;return(0,n4.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o=(a=n()).dispatchMessage,i=a.updateMessageContent,o({id:t,key:"content",type:"updateMessage",value:r}),i(t,r);case 3:case"end":return e.stop()}},e)})),function(e,n){return t.apply(this,arguments)}),dispatchMessage:function(t){var r=n(),a=r.chats,o=r.onChatsChange,i=tw(a,t);e({chats:i},!1,tj("dispatchMessage")),null==o||o(i)},generateMessage:(r=(0,n3.Z)((0,n4.Z)().mark(function e(t,r){var a,o,i,s,l,c,u,d,p,g,f,h,m,v,x,y,Z,C,k,b,M;return(0,n4.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=(a=n()).dispatchMessage,i=a.toggleChatLoading,s=a.config,l=a.defaultModelFetcher,c=a.createSmoothMessage,u=a.transformToChatMessage,d=a.updateMessageContent,p=i(!0,r,tj("generateMessage(start)",{assistantId:r,messages:t})),g=nB(t,s),f=function(e){var n=(0,tv.Z)(s.inputTemplate,{interpolate:/{{([\S\s]+?)}}/g});return e.map(function(e){if("user"===e.role)try{return(0,$.Z)((0,$.Z)({},e),{},{content:n({text:e.content})})}catch(e){console.error(e)}return e})},h=s.inputTemplate?f(g):g,s.systemRole&&h.unshift({content:s.systemRole,role:"system"}),m=function(){return l((0,$.Z)({messages:h,model:s.model},s.params),{signal:null==p?void 0:p.signal})},v="",x=!1,Z=(y=c(r)).startAnimation,C=y.stopAnimation,k=y.outputQueue,b=y.isAnimationActive,e.next=12,ty(m,{onErrorHandle:function(e){o({id:r,key:"error",type:"updateMessage",value:e})},onAbort:function(){var e=(0,n3.Z)((0,n4.Z)().mark(function e(){return(0,n4.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:C();case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),onFinish:function(){var e=(0,n3.Z)((0,n4.Z)().mark(function e(n){return(0,n4.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(C(),!(k.length>0&&!x)){e.next=4;break}return e.next=4,Z(15);case 4:return e.next=6,d(r,n);case 6:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}(),onMessageHandle:function(){var e=(0,n3.Z)((0,n4.Z)().mark(function e(n){return(0,n4.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(v+=n,b||x||Z(),!(null!=p&&p.signal.aborted)){e.next=6;break}return e.abrupt("return");case 6:if(e.t0=k,!u){e.next=13;break}return e.next=10,u(n,v);case 10:e.t1=e.sent,e.next=14;break;case 13:e.t1=n;case 14:e.t2=e.t1,e.t0.push.call(e.t0,e.t2);case 16:v.startsWith('{"function')&&(x=!0);case 17:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}()});case 12:return function e(){clearTimeout(M),void 0===k||0===k.length||""===k.toString()?(i(!1,void 0,tj("generateMessage(end)")),clearTimeout(M)):M=setTimeout(e,30)}(),e.abrupt("return",{isFunctionCall:x});case 15:case"end":return e.stop()}},e)})),function(e,n){return r.apply(this,arguments)}),realFetchAIResponse:(a=(0,n3.Z)((0,n4.Z)().mark(function e(t,r){var a,o,i,s,l,c;return(0,n4.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=(a=n()).dispatchMessage,i=a.generateMessage,s=a.config,l=a.getMessageId,e.next=3,l(t,r);case 3:return o({id:c=e.sent,message:"...",parentId:r,role:"assistant",type:"addMessage"}),o({id:c,key:"fromModel",type:"updateMessageExtra",value:s.model}),e.next=8,i(t,c);case 8:case"end":return e.stop()}},e)})),function(e,n){return a.apply(this,arguments)}),resendMessage:(o=(0,n3.Z)((0,n4.Z)().mark(function e(t){var r,a,o,i,s,l,c,u;return(0,n4.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!((a=(r=nL.currentChats(n())).findIndex(function(e){return e.id===t}))<0)){e.next=4;break}return e.abrupt("return");case 4:o=r[a],i=[],e.t0=o.role,e.next="function"===e.t0?9:"user"===e.t0?9:"assistant"===e.t0?11:15;break;case 9:return i=r.slice(0,a+1),e.abrupt("break",15);case 11:return s=o.parentId,l=r.findIndex(function(e){return e.id===s}),i=r.slice(0,l<0?a+1:l+1),e.abrupt("break",15);case 15:if(!(i.length<=0)){e.next=17;break}return e.abrupt("return");case 17:if(c=n().realFetchAIResponse,u=i.filter(function(e){return"user"===e.role}).at(-1)){e.next=21;break}return e.abrupt("return");case 21:return e.next=23,c(i,u.id);case 23:case"end":return e.stop()}},e)})),function(e){return o.apply(this,arguments)}),sendMessage:(i=(0,n3.Z)((0,n4.Z)().mark(function e(t){var r,a,o,i,s;return(0,n4.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=(r=n()).dispatchMessage,o=r.realFetchAIResponse,t){e.next=3;break}return e.abrupt("return");case 3:return a({id:i=tZ(),message:t,role:"user",type:"addMessage"}),s=nL.currentChats(n()),e.next=8,o(s,i);case 8:case"end":return e.stop()}},e)})),function(e){return i.apply(this,arguments)}),stopGenerateMessage:function(){var e=n(),t=e.abortController,r=e.toggleChatLoading,a=e.chatLoadingId,o=e.chats,i=e.dispatchMessage;o&&o.length>0&&"..."===o[o.length-1].content&&i({id:a,key:"content",type:"updateMessage",value:""}),t&&(t.abort(),r(!1))},toggleChatLoading:function(n,t,r){if(n){var a=new AbortController;return e({abortController:a,chatLoadingId:t},!1,r),a}e({abortController:void 0,chatLoadingId:void 0},!1,r)},defaultModelFetcher:function(e,t){var r=n().request,a=(0,tf.Z)((0,$.Z)({model:tC.model,stream:!0},tC.params),e);if("function"==typeof r)return r(a.messages,a,null==t?void 0:t.signal);var o="string"==typeof r?r:"/api/openai/chat";return fetch(o,{body:JSON.stringify(a),headers:{"Content-Type":"application/json"},method:"POST",signal:null==t?void 0:t.signal})},getMessageId:(s=(0,n3.Z)((0,n4.Z)().mark(function e(t,r){var a;return(0,n4.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("function"!=typeof(a=n().genMessageId)){e.next=3;break}return e.abrupt("return",a(t,r));case 3:return e.abrupt("return",tZ());case 4:case"end":return e.stop()}},e)})),function(e,n){return s.apply(this,arguments)}),createSmoothMessage:function(e){var t=n().dispatchMessage,r="",a=[],o=null,i=!1;return{startAnimation:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return new Promise(function(s){if(i){s();return}i=!0,function l(){i||(clearTimeout(o),o=null,s()),a.length>0?(t({id:e,key:"content",type:"updateMessage",value:r+=a.splice(0,n).join("")}),o=setTimeout(l,16)):(i=!1,o=null,s())}()})},stopAnimation:function(){i=!1,null!==o&&(clearTimeout(o),o=null)},outputQueue:a,isAnimationActive:!1}},getChatLoadingId:function(){return n().chatLoadingId}}},tT=["loading","initialChats","chats"],tN=function(e){var n=e.loading,t=e.initialChats,r=e.chats,a=(0,ee.Z)(e,tT);return function(){var e=null!=r?r:t,o=(0,tf.Z)({},tk,(0,$.Z)({init:!n,chats:Array.isArray(e)?e:Object.values(e||{})},a));return(0,$.Z)((0,$.Z)({},o),tS.apply(void 0,arguments))}},tR=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=(0,th.v)(!1!==n),r=!1===n?void 0:!0===n?{name:"PRO_CHAT"}:n;return(0,tm.F)()(t(tN(e),r),nM())},tE=["children","devtoolOptions","chats","onChatsChange","loading","helloMessage","userMeta","inputAreaProps","assistantMeta","actions","transformToChatMessage","request","locale"],tz=(0,q.memo)(function(e){var n=e.children,t=e.devtoolOptions,r=e.chats,a=e.onChatsChange,o=e.loading,i=e.helloMessage,s=e.userMeta,l=e.inputAreaProps,c=e.assistantMeta,u=e.actions,d=e.transformToChatMessage,p=e.request,g=e.locale,f=(0,ee.Z)(e,tE),h=!0,m=(0,el.jsxs)(el.Fragment,{children:[n,(0,el.jsx)(tg,{chatRef:f.chatRef,init:!o,helloMessage:i,chats:r,actions:u,userMeta:s,request:p,transformToChatMessage:d,inputAreaProps:l,assistantMeta:c,onChatsChange:a,locale:g})]});try{nE()}catch(e){h=!1}return h?m:(0,el.jsx)(nz,{createStore:function(){return tR(f,t)},children:m})}),tA=["renderInputArea","__PRO_CHAT_STORE_DEVTOOLS__","showTitle","style","className","chatItemRenderConfig","backToBottomConfig","appStyle","inputRender","markdownProps","renderErrorMessages","inputAreaRender","itemShouldUpdate","onScroll","sendButtonRender"];function tD(e){var n=e.renderInputArea,t=e.__PRO_CHAT_STORE_DEVTOOLS__,r=e.showTitle,a=e.style,o=e.className,i=e.chatItemRenderConfig,s=e.backToBottomConfig,l=e.appStyle,c=e.inputRender,u=e.markdownProps,d=e.renderErrorMessages,p=e.inputAreaRender,g=e.itemShouldUpdate,f=e.onScroll,h=e.sendButtonRender,m=(0,ee.Z)(e,tA);return(0,el.jsx)(tz,(0,$.Z)((0,$.Z)({},m),{},{devtoolOptions:t,children:(0,el.jsx)(en.Z,{style:(0,$.Z)({height:"100%",width:"100%",position:"relative"},l),className:o,children:(0,el.jsx)(tu,{chatItemRenderConfig:i,inputRender:c,sendButtonRender:h,inputAreaRender:n||p,chatRef:m.chatRef,showTitle:r,style:a,onScroll:f,itemShouldUpdate:g,renderErrorMessages:d,backToBottomConfig:s,className:o,markdownProps:u})})}))}var tI=t(9844);let{Search:tP}=Y.default,tB=()=>{let[e,n]=(0,q.useState)(!1),[t,r]=(0,q.useState)(""),a=(0,J.Fg)(),o=async e=>{try{n(!0);let t=await K.Z.chat(e);return t.content}catch(e){console.log("error",e)}finally{n(!1)}},i=async e=>{let n=await o(e);return new Promise(e=>{setTimeout(()=>{e(n||"")},2e3)})},{chatHistory:s,chatLoading:l}=(0,tI.Z)();return(0,G.tZ)("div",{className:"side-item search-bar",children:l?(0,G.tZ)(ez,{}):(0,G.tZ)("div",{style:{background:a.colorBgLayout},children:(0,G.tZ)(tD,{request:async e=>{var n;let t=await i(null==e?void 0:null===(n=e[(null==e?void 0:e.length)-1])||void 0===n?void 0:n.content);return new Response(t)},style:{height:"100vh"},initialChats:(null==s?void 0:s.map(e=>({...e,createAt:e.created_at,updateAt:e.created_at,role:"user"===e.owner?"user":"system",error:void 0})))||[]})})})};var tH=()=>(0,G.tZ)(tB,{})}}]);