"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9471],{89471:function(e,n,t){t.r(n),t.d(n,{default:function(){return tG}});var r,a,o,i,s,l,c,u,d,p,g,f,h,m,v,x,y,Z,C,b,k,M,w,j,S,T,N,R,E,z,A,D,I,P,B,H,F,O,L,_,U,W,X,V,G,Y=t(82729),q=t(35944),Q=t(80738),K=t(51024),J=t(67294),$=t(84626),ee=t(34973),en=t(1413),et=t(45987),er=t(57605),ea=t(97685),eo=t(30168),ei=t(65400),es=t.n(ei),el=t(31535),ec=(0,ee.kc)(function(e){var n=e.css,t=(0,ee.F4)(o||(o=(0,eo.Z)(["\n  0% {\n    rotate: 0deg;\n  }\n  100% {\n    rotate: 360deg;\n  }\n  "])));return{spin:n(i||(i=(0,eo.Z)(["\n      animation: "," 1s linear infinite;\n    "])),t)}}),eu=t(85893),ed=["icon","size","color","fill","className","spin"],ep=function(e){var n,t;switch(e){case"large":n=24,t=2;break;case"normal":n=20,t=2;break;case"small":n=14,t=1.5;break;default:e?(n=(null==e?void 0:e.fontSize)||24,t=(null==e?void 0:e.strokeWidth)||2):(n="1em",t=2)}return{fontSize:n,strokeWidth:t}},eg=(0,J.memo)(function(e){var n=e.icon,t=e.size,r=e.color,a=e.fill,o=e.className,i=e.spin,s=(0,et.Z)(e,ed),l=ec(),c=l.styles,u=l.cx,d=(0,J.useMemo)(function(){return ep(t)},[t]),p=d.fontSize,g=d.strokeWidth;return(0,eu.jsx)("span",(0,en.Z)((0,en.Z)({className:u("anticon",i&&c.spin,o),role:"img"},s),{},{children:(0,eu.jsx)(n,{color:r,fill:null!=a?a:"transparent",focusable:!1,height:p,size:p,strokeWidth:g,width:p})}))}),ef=(0,ee.kc)(function(e,n){var t=e.token,r=e.css,a=e.stylish;return(0,e.cx)(a.blur,r(s||(s=(0,eo.Z)(["\n      pointer-events: ",";\n\n      transform: translateY(",");\n\n      padding-inline: 12px !important;\n\n      opacity: ",";\n      background: ",";\n      border-color: "," !important;\n      border-radius: 16px !important;\n      backdrop-filter: blur(16px);\n    "])),n?"all":"none",n?0:"16px",n?1:0,t.colorFillSecondary,t.colorFillTertiary))}),eh=function(e){var n=e||{},t=n.visibilityHeight,r=void 0===t?240:t,a=n.target,o=n.onClick,i=n.style,s=n.className,l=n.text,c=n.render,u=n.onScroll,d=n.alwaysShow,p=void 0!==d&&d,g=(0,J.useState)(p),f=(0,ea.Z)(g,2),h=f[0],m=f[1],v=ef(h),x=v.styles,y=v.cx,Z=(0,J.useRef)(null),C=(0,J.useState)(!1),b=(0,ea.Z)(C,2),k=b[0],M=b[1];(0,J.useEffect)(function(){M(!0)},[]);var w=(0,J.useMemo)(function(){return a.current?a.current:document.body},[k]),j=(null==w?void 0:w.scrollHeight)||0,S=(null==w?void 0:w.clientHeight)||0,T=(0,J.useState)({top:0,left:0}),N=(0,ea.Z)(T,2),R=N[0],E=N[1],z=(0,J.useRef)(null);(0,J.useEffect)(function(){if(void 0!==w){var e,n=function(e){null==u||u(e),z.current=window.setTimeout(function(){p||m((null==w?void 0:w.scrollTop)+S+r<j),E({top:null==w?void 0:w.scrollTop,left:null==w?void 0:w.scrollLeft})},60)};return null==w||null===(e=w.addEventListener)||void 0===e||e.call(w,"scroll",n,{passive:!0}),function(){var e;z.current&&clearTimeout(z.current),null==w||null===(e=w.removeEventListener)||void 0===e||e.call(w,"scroll",n)}}},[w]),(0,J.useEffect)(function(){p||m((null==R?void 0:R.top)+S+r<j)},[j,R,r,w]);var A=function(e){var n;null==a||null===(n=a.current)||void 0===n||n.scrollTo({behavior:"smooth",left:0,top:j}),null==o||o(e)};(0,J.useEffect)(function(){setTimeout(function(){var e;null==a||null===(e=a.current)||void 0===e||e.scrollTo({behavior:"smooth",left:0,top:j})},16)},[]);var D=(0,eu.jsx)(es(),{className:y(x,s),icon:(0,eu.jsx)(eg,{icon:el.Z}),onClick:A,ref:Z,size:"small",style:(0,en.Z)({bottom:18,position:"absolute",right:16},i),children:l||"Back to bottom"});return c?c(D,A,e):D},em=t(9220),ev=t(17542),ex=t(31929),ey=t(20640),eZ=t.n(ey),eC=t(27950),eb=(0,J.memo)(function(e){var n=e.actions,t=e.className;return(0,eu.jsx)(ev.D,{align:"flex-start",className:t,role:"menubar",children:n})}),ek=t(84960),eM=(0,ee.kc)(function(e){var n=e.css,t=e.token;return{container:n(l||(l=(0,eo.Z)(["\n      position: relative;\n\n      display: flex;\n      align-items: center;\n      justify-content: center;\n\n      line-height: 1;\n      text-align: center;\n    "]))),loading:n(c||(c=(0,eo.Z)(["\n      position: absolute;\n      inset: 0;\n\n      display: flex;\n      align-items: center;\n      justify-content: center;\n\n      width: 100%;\n      height: 100%;\n\n      color: ",";\n    "])),t.colorText)}}),ew=(0,J.memo)(function(e){var n=e.emoji,t=e.className,r=e.style,a=e.size,o=void 0===a?40:a,i=eM(),s=i.cx,l=i.styles;return(0,eu.jsx)("div",{className:s(l.container,t),style:(0,en.Z)({fontSize:.9*o,height:o,width:o},r),children:n})}),ej=t(24571),eS=function(e){var n,t=(0,ej.Z)();return null===(n=e.match(t))||void 0===n?void 0:n[0]},eT=t(84967),eN=(0,ee.kc)(function(e,n){var t=e.css,r=e.token,a=e.prefixCls,o=n.background,i=n.size,s=n.isEmoji,l=null!=o?o:r.colorBgContainer,c=(0,eT.XV)(l);return{avatar:t(u||(u=(0,eo.Z)(["\n        cursor: pointer;\n\n        display: flex;\n        align-items: center;\n        justify-content: center;\n\n        background: ",";\n        border: 1px solid ",";\n\n        > .","-avatar-string {\n          font-size: ","px;\n          font-weight: 700;\n          line-height: 1 !important;\n          color: ",";\n        }\n\n        > * {\n          cursor: pointer;\n        }\n      "])),l,o?"transparent":r.colorSplit,a,i*(s?.7:.5),c)}}),eR=["className","avatar","title","size","shape","background","onClick","style"],eE=(0,J.memo)(function(e){var n=e.className,t=e.avatar,r=e.title,a=e.size,o=void 0===a?40:a,i=e.shape,s=e.background,l=e.onClick,c=e.style,u=(0,et.Z)(e,eR),d=!!(t&&["/","http","data:"].some(function(e){return t.startsWith(e)})),p=!!(null==t?void 0:t.startsWith("data")),g=(0,J.useMemo)(function(){return t&&!d&&eS(t)},[t]),f=eN({background:void 0===s?"rgba(0,0,0,0)":s,isEmoji:!!g,size:o}),h=f.styles,m=f.cx,v=String(d?r:t),x={className:m(h.avatar,n),shape:void 0===i?"circle":i,size:o,style:l?c:(0,en.Z)({cursor:"default"},c)};return d?(0,eu.jsx)(ek.ZP,(0,en.Z)((0,en.Z)({src:p?t:(0,eu.jsx)("img",{src:t,alt:"avatar"})},x),u)):(0,eu.jsx)(ek.ZP,(0,en.Z)((0,en.Z)((0,en.Z)({},x),u),{},{children:g?(0,eu.jsx)(ew,{emoji:g,size:.8*o}):null==v?void 0:v.toUpperCase().slice(0,2)}))}),ez=(0,ee.kc)(function(e,n){var t=e.cx,r=e.css,a=e.token,o=e.isDarkMode,i=e.responsive,s=n.placement,l=n.type,c=n.title,u=n.primary,R=n.avatarSize,E=n.showTitle,z=n.editing,A=r(d||(d=(0,eo.Z)(["\n      padding: 8px 12px;\n      background-color: ",";\n      border-radius: ","px;\n      transition: background-color 100ms ",";\n    "])),u?o?a.colorFill:a.colorBgElevated:o?a.colorFillSecondary:a.colorBgContainer,a.borderRadiusLG,a.motionEaseOut),D=r(p||(p=(0,eo.Z)(["\n      padding-top: ",";\n    "])),c?0:"6px"),I=r(g||(g=(0,eo.Z)(["\n      margin-bottom: -16px;\n      transition: background-color 100ms ",";\n    "])),a.motionEaseOut),P="block"===l?A:D,B=z&&r(f||(f=(0,eo.Z)(["\n        width: 100%;\n      "])));return{actions:t(r(h||(h=(0,eo.Z)(["\n          align-self: ",";\n          justify-content: ",";\n        "])),"block"===l?"flex-end":"left"===s?"flex-start":"flex-end","left"===s?"flex-end":"flex-start"),z&&r(m||(m=(0,eo.Z)(["\n            pointer-events: none !important;\n            opacity: 0 !important;\n          "])))),alert:r(v||(v=(0,eo.Z)([""]))),avatarContainer:r(x||(x=(0,eo.Z)(["\n        position: relative;\n        flex: none;\n        width: ","px;\n        height: ","px;\n      "])),R,R),avatarGroupContainer:r(y||(y=(0,eo.Z)(["\n        width: ","px;\n      "])),R),container:t("pure"===l&&I,r(Z||(Z=(0,eo.Z)(["\n          position: relative;\n          width: 100%;\n          max-width: 100vw;\n          padding: 16px;\n          content-visibility: auto;\n          contain-intrinsic-size: 100px;\n          time {\n            display: inline-block;\n            white-space: nowrap;\n          }\n\n          div[role='menubar'] {\n            display: flex;\n          }\n\n          time,\n          div[role='menubar'] {\n            pointer-events: none;\n            opacity: 0;\n            transition: opacity 200ms ",";\n          }\n\n          &:hover {\n            time,\n            div[role='menubar'] {\n              pointer-events: unset;\n              opacity: 1;\n            }\n          }\n\n          "," {\n            padding: 4px 16px;\n          }\n        "])),a.motionEaseOut,i.mobile)),editingContainer:t(B,r(C||(C=(0,eo.Z)(["\n          padding: 8px 12px 12px;\n          border: 1px solid ",";\n\n          &:active,\n          &:hover {\n            border-color: ",";\n          }\n        "])),a.colorBorderSecondary,a.colorBorder),"pure"===l&&r(b||(b=(0,eo.Z)(["\n            background: ",";\n            border-radius: ","px;\n          "])),a.colorFillQuaternary,a.borderRadius)),editingInput:r(k||(k=(0,eo.Z)(["\n        width: 100%;\n      "]))),loading:r(M||(M=(0,eo.Z)(["\n        position: absolute;\n        right: ",";\n        bottom: 0;\n        left: ",";\n\n        width: 16px;\n        height: 16px;\n\n        color: ",";\n\n        background: ",";\n        border-radius: 50%;\n      "])),"left"===s?"-4px":"unset","right"===s?"-4px":"unset",a.colorBgLayout,a.colorPrimary),message:t(P,r(w||(w=(0,eo.Z)(["\n          position: relative;\n        "])))),messageContainer:t(B,r(j||(j=(0,eo.Z)(["\n          position: relative;\n        "])))),messageContent:t(B,r(S||(S=(0,eo.Z)(["\n          position: relative;\n          overflow-x: hidden;\n\n          "," {\n            flex-direction: column !important;\n          }\n        "])),i.mobile)),messageExtra:r(T||(T=(0,eo.Z)([""]))),name:r(N||(N=(0,eo.Z)(["\n        position: ",";\n        top: ",";\n        right: ",";\n        left: ",";\n\n        margin-bottom: 6px;\n\n        font-size: 12px;\n        line-height: 1;\n        color: ",";\n        text-align: ",";\n      "])),E?"relative":"absolute",E?"unset":"-16px","right"===s?"0":"unset","left"===s?"0":"unset",a.colorTextDescription,"left"===s?"left":"right")}}),eA=t(3389),eD=(0,J.memo)(function(e){var n=e.loading,t=ez({placement:e.placement}).styles;return n?(0,eu.jsx)(ev.D,{align:"center",className:t.loading,justify:"center",children:(0,eu.jsx)(eg,{icon:eA.Z,size:{fontSize:12,strokeWidth:3},spin:!0})}):null}),eI=(0,J.memo)(function(e){var n=e.loading,t=e.avatar,r=void 0===t?{}:t,a=e.placement,o=e.addon,i=e.onClick,s=e.size,l=void 0===s?40:s,c=ez({avatarSize:l}).styles,u=(0,eu.jsxs)("div",{className:c.avatarContainer,children:[(0,eu.jsx)(eE,{avatar:r.avatar,background:r.backgroundColor,onClick:i,size:l,title:r.title}),(0,eu.jsx)(eD,{loading:n,placement:a})]});return o?(0,eu.jsxs)(ev.D,{align:"center",className:c.avatarGroupContainer,gap:8,children:[u,o]}):u}),eP=(0,J.memo)(function(e){var n=e.borderSpacing;return n?(0,eu.jsx)("div",{style:{flex:"none",width:n}}):null}),eB=t(4863),eH=(0,J.memo)(function(e){var n=e.message,t=ez({placement:e.placement}).styles;return(0,eu.jsx)(ev.D,{gap:8,children:(0,eu.jsx)(eB.Z,{className:t.alert,showIcon:!0,type:"error",message:n})})}),eF=t(56790),eO=(0,ee.kc)(function(e,n){var t=e.cx,r=e.css,a=e.token,o=e.prefixCls,i=n.type,s=r(R||(R=(0,eo.Z)(["\n      background-color: ",";\n      border: 1px solid ",";\n      transition:\n        background-color 100ms ",",\n        border-color 200ms ",";\n\n      &:hover {\n        background-color: ",";\n      }\n\n      &:focus {\n        border-color: ",";\n      }\n\n      &.","-input-affix-wrapper-focused {\n        border-color: ",";\n      }\n    "])),"block"===i?a.colorFillTertiary:"transparent","block"===i?"transparent":a.colorBorder,a.motionEaseOut,a.motionEaseOut,a.colorFillTertiary,a.colorTextQuaternary,o,a.colorTextQuaternary);return{input:t("pure"!==i&&s,r(E||(E=(0,eo.Z)(["\n          position: relative;\n          max-width: 100%;\n          height: ",";\n          padding: ",";\n\n          input {\n            background: transparent;\n          }\n        "])),"pure"===i?"unset":"36px","pure"===i?"0":"0 12px")),textarea:t("pure"!==i&&s,r(z||(z=(0,eo.Z)(["\n          position: relative;\n          max-width: 100%;\n          padding: ",";\n          border-radius: ",";\n\n          textarea {\n            background: transparent;\n          }\n        "])),"pure"===i?"0":"8px 12px","pure"===i?"0":"".concat(a.borderRadius,"px")))}}),eL=["className","type","resize","style"],e_=(0,J.forwardRef)(function(e,n){var t=e.className,r=e.type,a=void 0===r?"ghost":r,o=e.resize,i=e.style,s=(0,et.Z)(e,eL),l=eO({type:a}),c=l.styles,u=l.cx;return(0,eu.jsx)(K.default.TextArea,(0,en.Z)({bordered:"pure"!==a,className:u(c.textarea,t),ref:n,style:void 0===o||o?i:(0,en.Z)({resize:"none"},i)},s))}),eU=(0,ee.kc)(function(e){var n=e.css,t=e.token;return n(A||(A=(0,eo.Z)(["\n    position: relative;\n\n    height: 100%;\n\n    font-family: ",";\n    font-size: 13px;\n    line-height: 1.8;\n  "])),t.fontFamilyCode)}),eW=["text","type","onCancel","defaultValue","onConfirm","renderButtons","textareaStyle","textareaClassname","placeholder","height","style","editButtonSize","classNames"],eX=(0,J.memo)(function(e){var n=e.text,t=e.type,r=e.onCancel,a=e.defaultValue,o=e.onConfirm,i=e.renderButtons,s=e.textareaStyle,l=e.textareaClassname,c=e.placeholder,u=e.height,d=void 0===u?"auto":u,p=e.style,g=e.editButtonSize,f=void 0===g?"middle":g,h=e.classNames,m=(0,et.Z)(e,eW),v=(0,J.useState)(a||""),x=(0,ea.Z)(v,2),y=x[0],Z=x[1],C=eU(),b=C.cx,k=C.styles,M="auto"===d;return(0,eu.jsxs)(ev.D,(0,en.Z)((0,en.Z)({gap:16,style:(0,en.Z)({flex:1,width:"100%"},p)},m),{},{children:[(0,eu.jsx)(e_,{autoSize:M,className:b(k,l),classNames:h,onBlur:function(e){return Z(e.target.value)},onChange:function(e){return Z(e.target.value)},placeholder:void 0===c?"Type something...":c,resize:!1,style:(0,en.Z)({height:M?"unset":d,minHeight:"100%"},s),type:void 0===t?"pure":t,value:y}),(0,eu.jsx)(ev.D,{direction:"horizontal-reverse",gap:8,children:i?i(y).map(function(e,n){return(0,eu.jsx)(es(),(0,en.Z)({size:"small"},e),n)}):(0,eu.jsxs)(eu.Fragment,{children:[(0,eu.jsx)(es(),{onClick:function(){null==o||o(y)},size:f,type:"primary",children:(null==n?void 0:n.confirm)||"Confirm"}),(0,eu.jsx)(es(),{onClick:r,size:f,children:(null==n?void 0:n.cancel)||"Cancel"})]})})]}))}),eV=t(33914),eG=t(56697),eY=(0,J.memo)(function(e){var n=e.editing,t=e.open,r=e.height,a=void 0===r?"auto":r,o=e.onOpenChange,i=e.onEditingChange,s=e.placeholder,l=e.value,c=e.onChange,u=e.text,d=e.footer,p=e.extra,g=e.markdownProps,f=(0,eC.F)().mobile,h=(0,eF.useMergedState)(!1,{onChange:i,value:n}),m=(0,ea.Z)(h,2),v=m[0],x=m[1],y=(0,eF.useMergedState)(!1,{onChange:o,value:t}),Z=(0,ea.Z)(y,2),C=Z[0],b=Z[1],k={height:"auto"===a?"unset":a,overflowX:"hidden",overflowY:"auto"};return(0,eu.jsx)(eG.default,{cancelText:(null==u?void 0:u.cancel)||"Cancel",footer:v?null:d,okText:(null==u?void 0:u.edit)||"Edit",onCancel:function(){return b(!1)},onOk:function(){return x(!0)},open:C,styles:f?{body:{padding:16}}:{},title:(null==u?void 0:u.title)||"Prompt",children:v?(0,eu.jsx)(eX,{defaultValue:l,height:a,onCancel:function(){return x(!1)},onConfirm:function(e){x(!1),null==c||c(e)},placeholder:s,text:{cancel:null==u?void 0:u.cancel,confirm:null==u?void 0:u.confirm},type:"block"}):(0,eu.jsxs)(eu.Fragment,{children:[p,(0,eu.jsx)(eV.Z,(0,en.Z)((0,en.Z)({},g),{},{style:l?(0,en.Z)((0,en.Z)({},k),null==g?void 0:g.style):(0,en.Z)((0,en.Z)((0,en.Z)({},k),null==g?void 0:g.style),{},{opacity:.5}),children:String(l||s)}))]})})}),eq=(0,J.memo)(function(e){var n=e.value,t=e.onChange,r=e.classNames,a=void 0===r?{}:r,o=e.onEditingChange,i=e.editing,s=e.openModal,l=e.onOpenChange,c=e.placeholder,u=void 0===c?"Type something...":c,d=e.showEditWhenEmpty,p=e.styles,g=e.height,f=e.inputType,h=e.editButtonSize,m=e.text,v=e.model,x=e.markdownProps,y=(0,eF.useMergedState)(!1,{onChange:o,value:i}),Z=(0,ea.Z)(y,2),C=Z[0],b=Z[1],k=(0,eF.useMergedState)(!1,{onChange:l,value:s}),M=(0,ea.Z)(k,2),w=M[0],j=M[1],S=(0,eu.jsx)(eX,{className:null==a?void 0:a.input,classNames:{textarea:null==a?void 0:a.textarea},defaultValue:n,editButtonSize:h,height:g,onCancel:function(){return b(!1)},onConfirm:function(e){null==t||t(e),b(!1)},placeholder:u,style:null==p?void 0:p.input,text:m,textareaClassname:null==a?void 0:a.input,type:f});return!n&&void 0!==d&&d?S:(0,eu.jsxs)(eu.Fragment,{children:[!w&&C?S:(0,eu.jsx)(eV.Z,(0,en.Z)((0,en.Z)({},x),{},{style:(0,en.Z)({height:"auto"===g?"unset":g,overflowX:"hidden",overflowY:"auto"},null==x?void 0:x.style),children:n||u})),(0,eu.jsx)(eY,{editing:C,extra:null==v?void 0:v.extra,footer:null==v?void 0:v.footer,height:g,onChange:function(e){return null==t?void 0:t(e)},onEditingChange:b,onOpenChange:function(e){j(e),b(!1)},markdownProps:x,open:w,placeholder:u,text:m,value:n})]})}),eQ=(0,J.memo)(function(e){var n=e.editing,t=e.onChange,r=e.onEditingChange,a=e.className,o=e.text,i=e.message,s=e.placement,l=e.messageExtra,c=e.renderMessage,u=e.markdownProps,d=e.type,p=e.primary,g=e.onDoubleClick,f=ez({editing:n,placement:s,primary:p,type:d}),h=f.cx,m=f.styles,v=(0,eC.F)().mobile,x=(0,(0,J.useContext)(ex.default.ConfigContext).getPrefixCls)("pro-chat"),y=(0,eu.jsx)(eq,{classNames:{input:m.editingInput},editButtonSize:"small",editing:n,fullFeaturedCodeBlock:!0,onChange:t,onEditingChange:r,openModal:v?n:void 0,text:o,value:String(i||"..."),markdownProps:u}),Z=c?c(y):y;return(0,eu.jsxs)(ev.D,{className:h(m.message,a,n&&m.editingContainer),onDoubleClick:g,children:[Z,l&&!n?(0,eu.jsx)("div",{className:"".concat(h(m.messageExtra,"".concat(x,"-message-extra"))),children:l}):null]})}),eK=t(27484),eJ=t.n(eK);t(34155);var e$=function(e){var n=eJ()(),t=eJ()(e);return t.isSame(n,"day")?t.format("HH:mm:ss"):t.isSame(n,"year")?t.format("MM-DD HH:mm:ss"):t.format("YYYY-MM-DD HH:mm:ss")},e0=(0,J.memo)(function(e){var n=e.showTitle,t=e.className,r=e.placement,a=e.time,o=e.avatar;return(0,eu.jsxs)(ev.D,{className:t,direction:"left"===r?"horizontal":"horizontal-reverse",gap:4,children:[n?o.title||"untitled":void 0,a&&(0,eu.jsx)("time",{children:e$(a)})]})}),e1=["avatarAddon","onAvatarClick","actions","className","primary","loading","message","placement","type","avatar","error","showTitle","time","editing","onChange","onEditingChange","messageExtra","renderMessage","text","chatItemRenderConfig","renderErrorMessages","markdownProps","onDoubleClick","originData"],e2=(0,J.memo)(function(e){var n,t=e.avatarAddon,r=e.onAvatarClick,a=e.actions,o=e.className,i=e.primary,s=e.loading,l=e.message,c=e.placement,u=void 0===c?"left":c,d=e.type,p=void 0===d?"block":d,g=e.avatar,f=e.error,h=e.showTitle,m=e.time,v=e.editing,x=e.onChange,y=e.onEditingChange,Z=e.messageExtra,C=e.renderMessage,b=e.text,k=e.chatItemRenderConfig,M=e.renderErrorMessages,w=e.markdownProps,j=e.onDoubleClick,S=e.originData,T=(0,et.Z)(e,e1),N=(0,eC.F)().mobile,R=ez({editing:v,placement:u,primary:i,showTitle:h,title:g.title,type:p}),E=R.cx,z=R.styles,A=(0,(0,J.useContext)(ex.default.ConfigContext).getPrefixCls)("pro-chat"),D=null==f?void 0:f.message,I=(0,J.useMemo)(function(){if((null==k?void 0:k.avatarRender)===!1)return null;var n,a=(0,eu.jsx)(eI,{addon:t,avatar:g,loading:s,onClick:r,placement:u,size:N?32:void 0});return(null==k||null===(n=k.avatarRender)||void 0===n?void 0:n.call(k,e,a))||a},[g,u,N,s]),P=(0,J.useMemo)(function(){if((null==k?void 0:k.contentRender)===!1)return null;var n,t=f?M?M(f):(0,eu.jsx)(eH,{message:D,placement:u}):(0,eu.jsx)(eQ,{editing:v,message:l,className:"".concat(A,"-list-item-message-content"),messageExtra:Z,onChange:x,onDoubleClick:j,onEditingChange:y,placement:u,primary:i,renderMessage:C,text:b,type:p,markdownProps:w});return(null==k||null===(n=k.contentRender)||void 0===n?void 0:n.call(k,e,t))||t},[f,l,Z,C,u,i,b,p,v,D,S]),B=(0,J.useMemo)(function(){if((null==k?void 0:k.actionsRender)===!1||f)return null;var n,t=(0,eu.jsx)(eb,{actions:a,className:"".concat(E(z.actions,"".concat(A,"-list-item-actions")))});return(null==k||null===(n=k.actionsRender)||void 0===n?void 0:n.call(k,e,t))||t},[a]),H=(0,J.useMemo)(function(){if((null==k?void 0:k.titleRender)===!1)return null;var n,t=(0,eu.jsx)(e0,{className:"".concat(E(z.name,"".concat(A,"-list-item-title"))),avatar:g,placement:u,showTitle:h,time:m});return(null==k||null===(n=k.titleRender)||void 0===n?void 0:n.call(k,e,t))||t},[m,g]);if((null==k?void 0:k.render)===!1)return null;var F=(0,eu.jsxs)(ev.D,(0,en.Z)((0,en.Z)({className:E(z.container,"".concat(A,"-list-item"),"".concat(A,"-list-item-").concat(u),o),direction:"left"===u?"horizontal":"horizontal-reverse",gap:N?6:12},T),{},{children:[I,(0,eu.jsxs)(ev.D,{align:"left"===u?"flex-start":"flex-end",className:E(z.messageContainer,"".concat(A,"-list-item-message-container")),children:[H,(0,eu.jsxs)(ev.D,{align:"left"===u?"flex-start":"flex-end",className:E(z.messageContent,"".concat(A,"-message-content")),direction:"block"===p?"left"===u?"horizontal":"horizontal-reverse":"vertical",gap:8,children:[P,B]})]}),N&&"block"===p&&(0,eu.jsx)(eP,{borderSpacing:32})]}));return(null==k||null===(n=k.render)||void 0===n?void 0:n.call(k,e,{avatar:I,messageContent:P,actions:B,title:H,itemDom:F},F))||F}),e4=t(74902),e3=function(e){var n=(0,J.useRef)(null);return n.current=e,(0,J.useCallback)(function(){for(var e,t=arguments.length,r=Array(t),a=0;a<t;a++)r[a]=arguments[a];return null===(e=n.current)||void 0===e?void 0:e.call.apply(e,[n].concat((0,e4.Z)(r)))},[])},e6=(0,ee.kc)(function(e,n){var t,r,a=e.css,o=e.token,i=e.isDarkMode,s=n.offset,l=n.outside,c=n.size,u=(null!==(t=null==s?void 0:s.x)&&void 0!==t?t:0)+"px",d=(null!==(r=null==s?void 0:s.y)&&void 0!==r?r:0)+"px";return a(D||(D=(0,eo.Z)(["\n      pointer-events: none;\n\n      position: absolute;\n      z-index: 1;\n      inset: 0;\n\n      opacity: ",";\n      background: radial-gradient(\n        "," circle at "," ",",\n        ",",\n        ","\n      );\n      border-radius: inherit;\n\n      transition: all 0.2s;\n    "])),l?"0":".1",c+"px",u,d,i?o.colorText:"#fff",i?"transparent":o.colorTextQuaternary)}),e8=["className","size"],e5=function(){var e=(0,J.useState)(),n=(0,ea.Z)(e,2),t=n[0],r=n[1],a=(0,J.useState)(!0),o=(0,ea.Z)(a,2),i=o[0],s=o[1],l=(0,J.useRef)();return(0,J.useEffect)(function(){if(l.current&&l.current.parentElement){var e=l.current.parentElement,n=function(n){var t=e.getBoundingClientRect();r({x:n.clientX-t.x,y:n.clientY-t.y}),s(!1)},t=function(){s(!0)};return e.addEventListener("mousemove",n),e.addEventListener("mouseleave",t),function(){e.removeEventListener("mousemove",n),e.removeEventListener("mouseleave",t)}}},[]),[t,i,l]},e9=(0,J.memo)(function(e){var n=e.className,t=e.size,r=(0,et.Z)(e,e8),a=e5(),o=(0,ea.Z)(a,3),i=o[0],s=o[1],l=o[2],c=e6({offset:i,outside:s,size:void 0===t?64:t}),u=c.styles,d=c.cx;return(0,eu.jsx)("div",(0,en.Z)({className:d(u,n),ref:l},r))}),e7=t(67148),ne=(0,ee.kc)(function(e,n){var t=e.css,r=e.stylish;return{block:(0,e.cx)(n.glass&&r.blur,t(I||(I=(0,eo.Z)(["\n          cursor: pointer;\n\n          position: relative;\n\n          display: flex;\n          flex: none;\n          align-items: center;\n          justify-content: center;\n        "]))))}}),nn=["color","fill","className","active","icon","size","style","glass","spotlight","onClick","children","loading","title","placement","arrow","tooltipDelay"],nt=function(e){var n,t;switch(e){case"large":n=44,t=8;break;case"normal":n=36,t=5;break;case"small":n=24,t=5;break;case"site":n=34,t=5;break;default:n=(null==e?void 0:e.blockSize)||36,t=(null==e?void 0:e.borderRadius)||5}return{blockSize:n,borderRadius:t}},nr=(0,J.forwardRef)(function(e,n){var t=e.color,r=e.fill,a=e.className,o=e.active,i=e.icon,s=e.size,l=void 0===s?"normal":s,c=e.style,u=e.glass,d=e.spotlight,p=e.onClick,g=e.children,f=e.loading,h=e.title,m=e.placement,v=e.arrow,x=e.tooltipDelay,y=(0,et.Z)(e,nn),Z=ne({active:!!o,glass:!!u}),C=Z.styles,b=Z.cx,k=(0,J.useMemo)(function(){return nt(l)},[l]),M=k.blockSize,w=k.borderRadius,j=(0,eu.jsxs)(eu.Fragment,{children:[i&&(0,eu.jsx)(eg,{color:t,fill:r,icon:i,size:"site"===l?"normal":l}),g]}),S=(0,eu.jsx)(eg,{color:t,icon:eA.Z,size:"site"===l?"normal":l,spin:!0}),T=(0,eu.jsxs)("div",(0,en.Z)((0,en.Z)({className:b(C.block,a),onClick:f?void 0:p,ref:n,style:(0,en.Z)({borderRadius:w,height:M,width:M},c)},y),{},{children:[d&&(0,eu.jsx)(e9,{}),f?S:j]}));return(0,eu.jsx)(eu.Fragment,{children:(0,eu.jsx)(e7.Z,(0,en.Z)((0,en.Z)({},y),{},{arrow:void 0!==v&&v,tooltipDelay:void 0===x?.5:x,placement:m,title:h,icon:T,size:M}))})}),na=t(33589),no=(0,J.memo)(function(e){var n=e.type,t=e.items,r=void 0===t?[]:t,a=e.placement,o=e.spotlight,i=void 0!==o&&o,s=e.direction,l=void 0===s?"row":s,c=e.dropdownMenu,u=void 0===c?null:c,d=e.onActionClick,p=e.className,g=e.style,f=a||("column"===l?"right":"top"),h=null==u?void 0:u.map(function(e){return(0,en.Z)((0,en.Z)({},e),{},{icon:(0,eu.jsx)(eg,{icon:e.icon,size:"small"}),onClick:d?function(n){return d({item:e,key:n.key,keyPath:n.keyPath})}:void 0})});return(0,eu.jsx)(na.W,{className:p,direction:l,type:void 0===n?"block":n,dropdownProps:{placement:f},style:g,dropdownMenu:h,render:function(){return(0,eu.jsxs)(eu.Fragment,{children:[i&&(0,eu.jsx)(e9,{}),(null==r?void 0:r.length)>0&&r.map(function(e){return(0,eu.jsx)(nr,{icon:e.icon,onClick:d?function(){return null==d?void 0:d({item:e,key:e.key,keyPath:[e.key]})}:void 0,placement:f,size:"small",title:e.label},e.key)})]})}})}),ni=t(76915),ns=t(96895),nl=t(62888),nc=t(13671),nu=["text"],nd=(0,J.memo)(function(e){var n=e.text,t=(0,et.Z)(e,nu),r={copy:{icon:ni.Z,key:"copy",label:(null==n?void 0:n.copy)||"Copy"},del:{icon:nc.Z,key:"del",label:(null==n?void 0:n.delete)||"Delete"},divider:{type:"divider"},edit:{icon:ns.Z,key:"edit",label:(null==n?void 0:n.edit)||"Edit"},regenerate:{icon:nl.Z,key:"regenerate",label:(null==n?void 0:n.regenerate)||"Regenerate"}},a=r.regenerate,o=r.edit,i=r.copy,s=r.divider,l=r.del;return(0,eu.jsx)(no,(0,en.Z)({dropdownMenu:[o,i,a,s,l],items:[a,o],type:"ghost"},t))}),np=["renderMessagesExtra","showTitle","onActionsClick","onMessageChange","originData","type","text","renderMessages","renderErrorMessages","renderActions","loading","groupNav","renderItems","chatItemRenderConfig","chatItemClassName","markdownProps"],ng=function(e){var n=e.renderMessagesExtra,t=e.showTitle,r=e.onActionsClick,a=e.onMessageChange,o=e.originData,i=e.type,s=e.text,l=e.renderMessages,c=e.renderErrorMessages,u=e.renderActions,d=e.loading,p=e.groupNav,g=e.renderItems,f=e.chatItemRenderConfig,h=e.chatItemClassName,m=e.markdownProps,v=(0,et.Z)(e,np),x=(0,J.useState)(!1),y=(0,ea.Z)(x,2),Z=y[0],C=y[1],b=er.Z.useApp().message,k=(0,J.useMemo)(function(){var e;if(g&&null!=v&&v.role&&(null!=g&&g[v.role]&&(e=g[v.role]),!e&&null!=g&&g.default&&(e=g.default),e))return e},[null==g?void 0:g[v.role]]),M=e3(function(e){var n,t=e.editableContent,r=e.data;if(l&&null!=v&&v.role&&(null!=l&&l[v.role]&&(n=l[v.role]),!n&&null!=l&&l.default&&(n=l.default),n))return(0,eu.jsx)(n,(0,en.Z)((0,en.Z)({},r),{},{editableContent:t}))}),w=e3(function(e){var t,r=e.data;if(n&&null!=v&&v.role&&(null!=n&&n[v.role]&&(t=n[v.role]),null!=n&&n.default&&(t=n.default),t||t))return(0,eu.jsx)(t,(0,en.Z)({},r))}),j=e3(function(e){var n,t=e.data;if(u&&null!=v&&v.role){null!=u&&u[v.role]&&(n=u[v.role]),null!=u&&u.default&&(n=u.default),n||(n=nd);var a=function(e,n){switch(e.key){case"copy":eZ()(n.content),b.success((null==s?void 0:s.copySuccess)||"Copy Success");break;case"edit":C(!0)}null==r||r(e,n)};return(0,eu.jsx)(n,(0,en.Z)((0,en.Z)({},t),{},{onActionClick:function(e){return null==a?void 0:a(e,t)},text:s}))}}),S=(0,J.useMemo)(function(){if(v.error)return v.error},[v.error]),T=(0,J.useMemo)(function(){return(0,eu.jsx)(e2,{className:h,"data-id":v.id,actions:(0,eu.jsx)(j,{data:v}),avatar:v.meta,avatarAddon:p,editing:Z,originData:o,error:S,renderErrorMessages:c,loading:d,message:v.content,messageExtra:(0,eu.jsx)(w,{data:v}),onChange:function(e){return null==a?void 0:a(v.id,e)},onDoubleClick:function(e){"default"!==v.id&&!v.error&&v.role&&["assistant","user"].includes(v.role)&&e.altKey&&C(!0)},onEditingChange:C,placement:"chat"===i&&"user"===v.role?"right":"left",primary:"user"===v.role,renderMessage:function(e){return(0,eu.jsx)(M,{data:v,editableContent:e})},showTitle:t,text:s,time:v.updateAt||v.createAt,type:"chat"===i?"block":"pure",chatItemRenderConfig:f,markdownProps:m})},[e.content,e.loading,e.id,v.meta,v.error,v.updateAt||v.createAt,Z]);return k?(0,eu.jsx)(k,(0,en.Z)({},e),v.id):T},nf=t(74253),nh=t(43777),nm=t(59361),nv=["icon","children","size"],nx=(0,ee.kc)(function(e){var n=e.cx,t=e.css,r=e.token;return{small:t(P||(P=(0,eo.Z)(["\n    padding: 2px 6px;\n    line-height: 1;\n  "]))),tag:n(t(B||(B=(0,eo.Z)(["\n    color: "," !important;\n    background: ",";\n    border: ","px;\n\n    &:hover {\n      color: ",";\n      background: ",";\n    }\n  "])),r.colorTextSecondary,r.colorFillSecondary,r.borderRadius,r.colorText,r.colorFill))}}),ny=(0,J.memo)(function(e){var n=e.icon,t=e.children,r=e.size,a=void 0===r?"default":r,o=(0,et.Z)(e,nv),i=nx(),s=i.styles,l=i.cx;return(0,eu.jsx)(nm.Z,(0,en.Z)((0,en.Z)({bordered:!1,className:l(s.tag,"small"===a&&s.small)},o),{},{children:(0,eu.jsxs)(ev.D,{align:"center",gap:4,horizontal:!0,children:[n,t]})}))}),nZ=(0,J.memo)(function(e){var n=e.enable,t=e.text;return n?(0,eu.jsx)("div",{style:{padding:"0 20px"},children:(0,eu.jsx)(nf.Z,{children:(0,eu.jsx)(ny,{icon:(0,eu.jsx)(eg,{icon:nh.Z}),children:t||"History Message"})})}):null}),nC=t(15671),nb=t(43144),nk=t(60136),nM=t(29388),nw=t(64063),nj=t.n(nw),nS=function(e){(0,nk.Z)(t,e);var n=(0,nM.Z)(t);function t(){return(0,nC.Z)(this,t),n.apply(this,arguments)}return(0,nb.Z)(t,[{key:"shouldComponentUpdate",value:function(e){if(e.shouldUpdate)return e.shouldUpdate(this.props,e);try{return!nj()(this.props.content,null==e?void 0:e.content)||!nj()(this.props.loading,null==e?void 0:e.loading)||!nj()(this.props.chatItemRenderConfig,null==e?void 0:e.chatItemRenderConfig)||!nj()(this.props.meta,null==e?void 0:e.meta)}catch(e){return!0}}},{key:"render",value:function(){return this.props.children}}]),t}(J.Component),nT=(0,ee.kc)(function(e){return{container:(0,e.css)(H||(H=(0,eo.Z)(["\n      position: relative;\n    "])))}}),nN=["onActionsClick","renderMessagesExtra","className","data","type","text","showTitle","itemShouldUpdate","onMessageChange","renderMessages","renderErrorMessages","loadingId","renderItems","enableHistoryCount","renderActions","historyCount","chatItemRenderConfig","markdownProps"],nR=(0,J.memo)(function(e){var n=e.onActionsClick,t=e.renderMessagesExtra,r=e.className,a=e.data,o=e.type,i=void 0===o?"chat":o,s=e.text,l=e.showTitle,c=e.itemShouldUpdate,u=e.onMessageChange,d=e.renderMessages,p=e.renderErrorMessages,g=e.loadingId,f=e.renderItems,h=e.enableHistoryCount,m=e.renderActions,v=e.historyCount,x=void 0===v?0:v,y=e.chatItemRenderConfig,Z=e.markdownProps,C=(0,et.Z)(e,nN),b=nT(),k=b.cx,M=b.styles,w=(0,(0,J.useContext)(ex.default.ConfigContext).getPrefixCls)("pro-chat");return(0,eu.jsx)("div",(0,en.Z)((0,en.Z)({className:k(M.container,"".concat(w,"-list"),r)},C),{},{children:a.map(function(e,r){var o={loading:g===e.id,onActionsClick:n,onMessageChange:u,renderActions:m,renderErrorMessages:p,renderItems:f,renderMessages:d,renderMessagesExtra:t,showTitle:l,text:s,type:i},v=a.length;return(0,eu.jsx)(nS,(0,en.Z)((0,en.Z)((0,en.Z)({},o),e),{},{shouldUpdate:c,children:(0,eu.jsxs)(J.Fragment,{children:[(0,eu.jsx)(nZ,{enable:h&&v>x&&x===v-r+1,text:null==s?void 0:s.history}),(0,eu.jsx)(ng,(0,en.Z)((0,en.Z)((0,en.Z)({},o),e),{},{originData:e,chatItemRenderConfig:y,markdownProps:Z}))]})}),e.id)})}))}),nE=(0,t(33869).k)(),nz=nE.useStore,nA=nE.useStoreApi,nD=nE.Provider,nI=t(29144),nP={placeholder:"Please enter a message...",backToBottom:"Back to bottom",clearCurrentDialogue:"Clear current dialogue",clearDialogue:"Clear dialogue",clearModalTitle:"You are about to clear the session, and you will not be able to retrieve it after clearing. Do you want to clear the current session?",defaultHelloMessage:"Let us start chatting",cancel:"Cancel",confirm:"Confirm",copy:"Copy",copySuccess:"Copy Success",delete:"Delete",edit:"Edit",history:"History",regenerate:"Regenerate"},nB={"en-US":nP,"zh-CN":{placeholder:"Nhập c\xe2u hỏi",backToBottom:"Quay lại",clearCurrentDialogue:"Xo\xe1 cuộc tr\xf2 chuyện hiện tại",clearDialogue:"Xo\xe1 to\xe0n bộ cuộc tr\xf2 chuyện",clearModalTitle:"Bạn sắp x\xf3a phi\xean của m\xecnh. Sau khi x\xf3a, bạn sẽ kh\xf4ng thể truy xuất phi\xean đ\xf3. X\xf3a phi\xean hiện tại?",defaultHelloMessage:"Xin ch\xe0o!",cancel:"Huỷ",confirm:"X\xe1c nhận",copy:"Copy",copySuccess:"Copy th\xe0nh c\xf4ng",delete:"Xo\xe1",edit:"Sửa",history:"Lịch sử",regenerate:"T\xe1i tạo"},"zh-HK":{placeholder:"請輸入訊息...",backToBottom:"回到底部",clearCurrentDialogue:"清除當前對話",clearDialogue:"清除對話",clearModalTitle:"您即將清除會話，清除後將無法恢復。您確定要清除當前會話嗎？",defaultHelloMessage:"讓我們開始聊天吧",cancel:"取消",confirm:"確認",copy:"複製",copySuccess:"複製成功",delete:"刪除",edit:"編輯",history:"歷史",regenerate:"重新生成"},en:nP},nH=function(e){return nB[e]||nB["en-US"]},nF=function(e,n){return n.enableHistoryCount&&n.historyCount?e.reverse().slice(0,n.historyCount).reverse():e},nO=["avatar","title","backgroundColor"],nL=function(e){if(0===Object.keys(e.chats).length)return[];var n,t=function(n){var t=e.userMeta,r=t.avatar,a=t.title,o=(t.backgroundColor,(0,et.Z)(t,nO)),i=e.assistantMeta;switch(null==n?void 0:n.role){case"user":return(0,en.Z)({avatar:r,title:a},o);case"system":return i;case"assistant":return{avatar:null==i?void 0:i.avatar,backgroundColor:null==i?void 0:i.backgroundColor,title:null==i?void 0:i.title}}return(0,en.Z)({},n)},r=e.chats.map(function(e){return(0,en.Z)((0,en.Z)({},e),{},{meta:t(e)})}),a=[],o=function(e){a.findIndex(function(n){return e.id===n.id})>-1||a.push(e)},i=(0,nI.Z)(r);try{for(i.s();!(n=i.n()).done;){var s=n.value;o(s);var l,c=(0,nI.Z)(r);try{for(c.s();!(l=c.n()).done;){var u=l.value;u.parentId===s.id&&o(u)}}catch(e){c.e(e)}finally{c.f()}}}catch(e){i.e(e)}finally{i.f()}return a},n_=function(e){return nF(nL(e),e.config)},nU={chatsMessageString:function(e){return n_(e).map(function(e){return e.content}).join("")},currentChats:nL,currentChatsWithGuideMessage:function(e){var n,t=nL(e);return 0!==t.length?t:[(0,en.Z)({content:null!==(n=e.helloMessage)&&void 0!==n?n:nH(e.locale).defaultHelloMessage,createAt:Date.now(),extra:{},id:"default",meta:e.assistantMeta,role:"hello",updateAt:Date.now()},t)]},currentChatsWithHistoryConfig:n_},nW=function(){var e=nz(function(e){return e.locale}),n=(0,J.useMemo)(function(){return nH(e)},[e]);return{locale:e,localeObject:n}},nX=["extra"],nV=(0,J.memo)(function(e){var n=e.extra,t=(0,et.Z)(e,nX),r=nz(function(e){return[e.config.model,e.messageItemExtraRender]}),a=(0,ea.Z)(r,2),o=a[0],i=a[1],s=(null==n?void 0:n.fromModel)&&o!==(null==n?void 0:n.fromModel),l=!!(null!=n&&n.translate),c=null==i?void 0:i((0,en.Z)({extra:n},t),"assistant");if(s||l||c)return(0,eu.jsxs)(ev.D,{gap:8,style:{marginTop:8},children:[s&&(0,eu.jsx)("div",{children:(0,eu.jsx)(ny,{children:null==n?void 0:n.fromModel})}),c]})}),nG=["extra"],nY={assistant:nV,user:(0,J.memo)(function(e){var n=e.extra,t=(0,et.Z)(e,nG),r=!!(null!=n&&n.translate),a=nz(function(e){return[e.messageItemExtraRender]}),o=(0,ea.Z)(a,1)[0],i=null==o?void 0:o((0,en.Z)({extra:n},t),"user");if(i)return(0,eu.jsxs)(ev.D,{gap:8,style:{marginTop:r?8:0},children:[(null==n?void 0:n.translate)&&(0,eu.jsx)("div",{children:(0,eu.jsx)(nf.Z,{style:{margin:"12px 0"}})}),i]})})},nq=function(){return(0,eu.jsxs)("svg",{viewBox:"0 0 32 24",xmlns:"http://www.w3.org/2000/svg",children:[(0,eu.jsx)("circle",{cx:"0",cy:"12",r:"0",transform:"translate(8 0)",children:(0,eu.jsx)("animate",{attributeName:"r",begin:"0",calcMode:"spline",dur:"1.2s",keySplines:"0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8;0.2 0.6 0.4 0.8",keyTimes:"0;0.2;0.7;1",repeatCount:"indefinite",values:"0; 4; 0; 0"})}),(0,eu.jsx)("circle",{cx:"0",cy:"12",r:"0",transform:"translate(16 0)",children:(0,eu.jsx)("animate",{attributeName:"r",begin:"0.3",calcMode:"spline",dur:"1.2s",keySplines:"0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8;0.2 0.6 0.4 0.8",keyTimes:"0;0.2;0.7;1",repeatCount:"indefinite",values:"0; 4; 0; 0"})}),(0,eu.jsx)("circle",{cx:"0",cy:"12",r:"0",transform:"translate(24 0)",children:(0,eu.jsx)("animate",{attributeName:"r",begin:"0.6",calcMode:"spline",dur:"1.2s",keySplines:"0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8;0.2 0.6 0.4 0.8",keyTimes:"0;0.2;0.7;1",repeatCount:"indefinite",values:"0; 4; 0; 0"})})]})},nQ=function(){var e=(0,ee.Fg)().colorTextTertiary;return(0,eu.jsx)("div",{style:{fill:e,height:24,width:32},children:(0,eu.jsx)(nq,{})})},nK=(0,J.memo)(function(e){var n=e.id,t=e.editableContent;return"..."===e.content?(0,eu.jsx)(nQ,{}):(0,eu.jsx)("div",{id:n,children:t})}),nJ=["id","content"],n$=(0,J.memo)(function(e){var n=e.id,t=e.content,r=(0,et.Z)(e,nJ);return(0,eu.jsx)(nK,(0,en.Z)({content:t,id:n},r))}),n0={hello:(0,J.memo)(function(e){var n=e.content;return"string"==typeof n?(0,eu.jsx)(nK,(0,en.Z)({},e)):n}),assistant:n$,default:nK},n1=t(10149),n2=(0,ee.kc)(function(e){var n=e.css,t=e.prefixCls;return{user:n(F||(F=(0,eo.Z)(["\n    display: flex;\n    flex-direction: row-reverse;\n    gap: 16px;\n\n    .","-skeleton-paragraph {\n      display: flex;\n      flex-direction: column;\n      align-items: flex-end;\n    }\n  "])),t)}}),n4=(0,J.memo)(function(){var e=n2().styles;return(0,eu.jsxs)(ev.D,{gap:24,padding:12,style:{marginTop:24},children:[(0,eu.jsx)(n1.default,{active:!0,avatar:{size:40},className:e.user,paragraph:{width:["50%","30%"]},title:!1}),(0,eu.jsx)(n1.default,{active:!0,avatar:{size:40},paragraph:{width:["50%","30%"]},title:!1})]})}),n3=(0,J.memo)(function(e){var n=e.showTitle,t=e.itemShouldUpdate,r=e.chatItemRenderConfig,a=e.renderErrorMessages,o=e.markdownProps,i=nz(nU.currentChatsWithGuideMessage,nj()),s=nW().localeObject,l=nz(function(e){return e.locale}),c=nz(function(e){var n=e.config;return[e.init,e.displayMode,n.enableHistoryCount,n.historyCount,e.chatLoadingId,e.deleteMessage,e.resendMessage,e.dispatchMessage]}),u=(0,ea.Z)(c,8),d=u[0],p=u[1],g=u[2],f=u[3],h=u[4],m=u[5],v=u[6],x=u[7],y=e3(function(e,n){var t=n.id,r=n.error;switch(e.key){case"del":m(t);break;case"regenerate":v(t),r&&m(t)}}),Z=e3(function(e,n){return x({id:e,key:"content",type:"updateMessage",value:n})}),C=(0,J.useMemo)(function(){return{cancel:s.cancel,confirm:s.confirm,copy:s.copy,copySuccess:s.copySuccess,delete:s.delete,edit:s.edit,history:s.history,regenerate:s.regenerate}},[l]);return d?(0,eu.jsx)(nR,{showTitle:n,data:i,itemShouldUpdate:t,enableHistoryCount:g,historyCount:f,loadingId:h,onActionsClick:y,onMessageChange:Z,renderMessages:n0,renderErrorMessages:a,renderMessagesExtra:nY,style:{marginTop:24},chatItemRenderConfig:r,text:C,type:p||"chat",markdownProps:o}):(0,eu.jsx)(n4,{})}),n6=t(74165),n8=t(15861),n5=t(88482),n9=t(35297),n7=t(13718),te=(0,ee.kc)(function(e){var n=e.css,t=e.token;return{extra:n(O||(O=(0,eo.Z)(["\n    color: ",";\n  "])),t.colorTextTertiary)}}),tn=function(e){var n,t=e.className,r=nz(function(e){var n,t;return[e.clearMessage,null===(n=e.actions)||void 0===n?void 0:n.render,null===(t=e.actions)||void 0===t?void 0:t.flexConfig]}),a=(0,ea.Z)(r,3),o=(a[0],a[1]),i=a[2],s=nW().localeObject,l=te(),c=l.styles,u=l.theme;return n9.Z,s.clearModalTitle,s.clearDialogue,s.cancel,s.clearCurrentDialogue,n7.Z,(0,eu.jsx)(ex.default,{theme:{token:{colorText:u.colorTextSecondary}},children:(0,eu.jsx)(ev.D,(0,en.Z)((0,en.Z)({align:"center",direction:"horizontal-reverse",paddingInline:12,className:(0,ee.cx)(c.extra,t),gap:8},i),{},{children:null!==(n=null==o?void 0:o(null))&&void 0!==n?n:null}))})},tt=t(17669),tr=["disabled","autoCompleteProps"],ta=J.forwardRef(function(e,n){var t,r=nz(function(e){return[e.autocompleteRequest]}),a=(0,ea.Z)(r,1)[0],o=e.disabled,i=e.autoCompleteProps,s=void 0===i?{}:i,l=(0,et.Z)(e,tr),c=(0,J.useState)([]),u=(0,ea.Z)(c,2),d=u[0],p=u[1],g=(0,J.useState)(!1),f=(0,ea.Z)(g,2),h=f[0],m=f[1];return(0,eu.jsx)(tt.Z,(0,en.Z)((0,en.Z)({className:e.className,options:d,style:{height:"max-content"},disabled:o,open:h,onDropdownVisibleChange:function(e){m(e)},value:e.value,onSelect:function(n){var t;null===(t=e.onChange)||void 0===t||t.call(e,{target:{value:n}}),p([])},onSearch:(t=(0,n8.Z)((0,n6.Z)().mark(function e(n){return(0,n6.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==a?void 0:a(n);case 2:p(e.sent||[]);case 4:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)})},s),{},{children:(0,eu.jsx)(K.default.TextArea,(0,en.Z)((0,en.Z)({size:"large"},l),{},{ref:n,disabled:o,className:"".concat(e.className,"-textarea"),onFocus:function(n){var t;m(!1),null===(t=e.onFocus)||void 0===t||t.call(e,n)},onPressEnter:function(n){var t;h&&d.length>0||null===(t=e.onPressEnter)||void 0===t||t.call(e,n)}}))}))}),to=(0,J.memo)(function(){var e=(0,ee.Fg)();return(0,eu.jsx)("svg",{className:"anticon",color:"currentColor",height:16,viewBox:"0 0 1024 1024",width:16,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",children:(0,eu.jsxs)("g",{fill:"none",children:[(0,eu.jsx)("circle",{cx:"512",cy:"512",fill:"none",r:"426",stroke:e.colorBorder,strokeWidth:"72"}),(0,eu.jsx)("rect",{fill:"currentColor",height:"252",rx:"24",ry:"24",width:"252",x:"386",y:"386"}),(0,eu.jsx)("path",{d:"M938.667 512C938.667 276.359 747.64 85.333 512 85.333",stroke:"currentColor",strokeLinecap:"round",strokeWidth:"73",children:(0,eu.jsx)("animateTransform",{attributeName:"transform",dur:"1s",from:"0 512 512",repeatCount:"indefinite",to:"360 512 512",type:"rotate"})})]})})}),ti=(0,ee.kc)(function(e){var n=e.css,t=e.responsive,r=e.token;return{container:n(L||(L=(0,eo.Z)(["\n    position: sticky;\n    z-index: ",";\n    bottom: 0;\n\n    padding-top: 12px;\n    padding-bottom: 24px;\n\n    background-image: linear-gradient(to top, "," 88%, transparent 100%);\n\n    "," {\n      width: 100%;\n    }\n  "])),r.zIndexPopupBase,r.colorBgLayout,t.mobile),boxShadow:n(_||(_=(0,eo.Z)(["\n    position: relative;\n    border-radius: 8px;\n    box-shadow: ",";\n  "])),r.boxShadowSecondary),input:n(U||(U=(0,eo.Z)(["\n    width: 100%;\n    border: none;\n    outline: none;\n    border-radius: 8px;\n  "]))),btn:n(W||(W=(0,eo.Z)(["\n    position: absolute;\n    z-index: 10;\n    right: 8px;\n    bottom: 6px;\n\n    color: ",";\n    &:hover {\n      color: ",";\n    }\n  "])),r.colorTextTertiary,r.colorTextSecondary),extra:n(X||(X=(0,eo.Z)(["\n    color: ",";\n  "])),r.colorTextTertiary)}}),ts=function(e){var n,t=e||{},r=t.className,a=t.onSend,o=t.inputAreaRender,i=t.inputRender,s=t.sendButtonRender,l=nz(function(e){return[e.sendMessage,!!e.chatLoadingId,e.placeholder,e.inputAreaProps,e.clearMessage,e.stopGenerateMessage]}),c=(0,ea.Z)(l,6),u=c[0],d=c[1],p=c[2],g=c[3],f=c[4],h=c[5],m=(0,J.useContext)(ex.default.ConfigContext).getPrefixCls,v=(0,J.useRef)(!1),x=ti(),y=x.styles,Z=x.theme,C=nW().localeObject,b=g||{},k=b.value,M=b.onChange,w=(0,J.useState)(""),j=(0,ea.Z)(w,2),S=j[0],T=j[1];(0,J.useEffect)(function(){!v.current&&M&&M(S)},[S]),(0,J.useEffect)(function(){k&&T(k)},[k]);var N=(n=(0,n8.Z)((0,n6.Z)().mark(function e(){return(0,n6.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=7;break}return e.next=3,a(S);case 3:e.sent&&(u(S),T("")),e.next=9;break;case 7:u(S),T("");case 9:case"end":return e.stop()}},e)})),function(){return n.apply(this,arguments)}),R=m("pro-chat-input-area"),E=(0,en.Z)((0,en.Z)({placeholder:p||C.placeholder},g),{},{className:(0,ee.cx)(y.input,null==g?void 0:g.className,"".concat(R,"-component")),value:S,onChange:function(e){T(e.target.value)},autoSize:{maxRows:8},onCompositionStart:function(){v.current=!0},onCompositionEnd:function(e){v.current=!1,T(e.target.value)},onPressEnter:function(e){d||e.shiftKey||v.current||(e.preventDefault(),N())}}),z=(0,eu.jsx)(ta,(0,en.Z)({},E)),A=i?null==i?void 0:i(z,function(e){u(e)},E):z,D=(0,J.useMemo)(function(){return d?{type:"text",className:y.btn,onClick:function(){return h()},icon:(0,eu.jsx)(to,{})}:{type:"text",className:y.btn,onClick:function(){return N()},icon:(0,eu.jsx)(n5.default,{})}},[d,S]),I=(0,eu.jsx)(es(),(0,en.Z)({},D)),P=s?s(I,D):I,B=(0,eu.jsx)(ex.default,{theme:{token:{borderRadius:4,colorBgContainer:Z.colorBgElevated,controlHeightLG:48,colorBorder:"transparent",colorPrimaryHover:"transparent"}},children:(0,eu.jsxs)(ev.D,{gap:8,padding:16,className:(0,ee.cx)(y.container,"".concat(R),r),children:[(0,eu.jsx)(tn,{className:"".concat(R,"-action-bar")}),(0,eu.jsxs)(ev.D,{horizontal:!0,gap:8,align:"center",className:(0,ee.cx)(y.boxShadow,"".concat(R,"-text-container")),children:[A,P]})]})});return o?o(B,function(e){u(e)},f):B},tl=t(56623),tc=(0,J.memo)(function(e){var n=e.target,t=nz(function(e){return!!e.chatLoadingId}),r=nz(nU.currentChats),a=(0,J.useState)(!1),o=(0,ea.Z)(a,2),i=o[0],s=o[1];(0,J.useEffect)(function(){s(!0)},[]);var l=(0,J.useMemo)(function(){return n.current?n.current:document.body},[i]),c=(0,J.useState)(0),u=(0,ea.Z)(c,2),d=u[0],p=u[1];(0,J.useEffect)(function(){i&&p(window.innerHeight/3>100?100:window.innerHeight/4)},[i]);var g=(0,tl.YD)({root:n.current,delay:100,rootMargin:"0px 0px ".concat(d,"px 0px"),trackVisibility:t}),f=g.ref,h=g.entry,m=g.inView;return(0,J.useEffect)(function(){t&&m&&(null==l||l.scrollTo({behavior:"smooth",left:0,top:(null==l?void 0:l.scrollHeight)||99999}))},[m,h,t,r]),(0,eu.jsx)("div",{ref:f,style:{height:1,width:"100%"}})}),tu=(0,ee.kc)(function(e){var n=e.token,t=e.prefixCls,r=e.cx,a="".concat(t,"-pro-chat");return{container:r(a,(0,ee.iv)(V||(V=(0,eo.Z)(["\n    line-height: 1;\n    text-size-adjust: none;\n    text-rendering: optimizelegibility;\n    vertical-align: baseline;\n\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    -webkit-overflow-scrolling: touch;\n    -webkit-tap-highlight-color: transparent;\n  }\n\n  ."," {\n    code {\n      font-family: "," !important;\n\n      span {\n        font-family: "," !important;\n      }\n    }\n\n    p {\n      word-wrap: break-word;\n    }\n\n    *::selection {\n      color: #000;\n      background: ",";\n\n      -webkit-text-fill-color: unset !important;\n    }\n\n    * {\n      box-sizing: border-box;\n      vertical-align: baseline;\n    }\n  }\n"])),a,n.fontFamilyCode,n.fontFamilyCode,n.blue3))}}),td=(0,ee.kc)(function(e){var n=e.css,t=e.responsive,r=e.stylish;return n(G||(G=(0,eo.Z)(["\n    overflow: hidden scroll;\n    height: 100%;\n    "," {\n      ","\n      width: 100%;\n    }\n  "])),t.mobile,r.noScrollbar)}),tp=(0,J.memo)(function(e){var n,t=e.renderInputArea,r=e.inputAreaRender,a=e.className,o=e.style,i=e.showTitle,s=e.chatRef,l=e.itemShouldUpdate,c=e.inputRender,u=e.chatItemRenderConfig,d=e.backToBottomConfig,p=e.renderErrorMessages,g=e.sendButtonRender,f=e.onScroll,h=e.markdownProps,m=(0,J.useRef)(null),v=(0,J.useRef)(null),x=td(),y=x.styles,Z=x.cx,C=tu().styles,b=(0,J.useState)(!1),k=(0,ea.Z)(b,2),M=k[0],w=k[1],j=(0,J.useState)("100%"),S=(0,ea.Z)(j,2),T=S[0],N=S[1],R=(0,J.useContext)(ex.default.ConfigContext).getPrefixCls,E=nW().localeObject;(0,J.useEffect)(function(){w(!0),null!=s&&s.current&&(s.current.scrollToBottom=function(){var e,n;null==m||null===(e=m.current)||void 0===e||e.scrollTo({behavior:"smooth",left:0,top:(null===(n=m.current)||void 0===n?void 0:n.scrollHeight)||99999})})},[]);var z=R("pro-chat");return(0,eu.jsx)(em.default,{onResize:function(e){e.height!==T&&N(e.height)},children:(0,eu.jsxs)(ev.D,{className:Z(C.container,a,"".concat(z,"-container")),style:(0,en.Z)({maxHeight:"100vh",height:"100%"},o),children:[(0,eu.jsxs)(eu.Fragment,{children:[(0,eu.jsxs)("div",{ref:m,className:Z("".concat(z,"-chat-list-container"),y),style:{height:T-((null===(n=v.current)||void 0===n?void 0:n.clientHeight)||0)||"100%"},children:[(0,eu.jsx)(n3,{showTitle:i,itemShouldUpdate:l,chatItemRenderConfig:u,markdownProps:h,renderErrorMessages:p}),(null==m?void 0:m.current)&&(0,eu.jsx)(tc,{target:m})]}),M&&null!=m&&m.current?(0,eu.jsx)(eh,(0,en.Z)({style:{bottom:138},onScroll:f,target:m,text:E.backToBottom},d)):null]}),null!==t&&null!==r&&(0,eu.jsx)("div",{ref:v,children:(0,eu.jsx)(ts,{sendButtonRender:g,inputAreaRender:r||t,inputRender:c})})]})})}),tg=t(43334),tf=function(){var e=nA(),n=e.getState(),t=n.resendMessage,r=n.sendMessage,a=n.stopGenerateMessage,o=n.deleteMessage,i=n.clearMessage,s=n.dispatchMessage,l=n.getChatLoadingId,c=e3(function(){return e.getState().chats}),u=e3(function(e){return s((0,en.Z)((0,en.Z)({},e),{},{type:"addMessage",message:null==e?void 0:e.content}))}),d=e3(function(){return nU.currentChats(e.getState())}),p=e3(function(e,n){s({type:"updateMessage",id:e,key:"content",value:n})}),g=e3(function(e,n,t){s({type:"updateMessage",id:e,key:n,value:t})});return(0,J.useMemo)(function(){return{getChats:c,pushChat:u,getChatMessages:d,resendMessage:t,sendMessage:r,getChatLoadingId:l,stopGenerateMessage:a,deleteMessage:o,clearMessage:i,setMessageContent:p,setMessageValue:g}},[])},th=(0,J.memo)(function(e){var n=e.init,t=e.onChatsChange,r=e.chatRef,a=e.request,o=e.userMeta,i=e.assistantMeta,s=e.helloMessage,l=e.transformToChatMessage,c=e.actions,u=e.inputAreaProps,d=e.chats,p=e.config,g=e.locale,f=nA(),h=(0,tg.N)(f);h("init",n),h("userMeta",o),h("assistantMeta",i),h("inputAreaProps",u),h("helloMessage",s),h("config",p),h("transformToChatMessage",l),h("actions",c),h("chats",d),h("onChatsChange",t),h("request",a),h("locale",g);var m=tf();return(0,J.useImperativeHandle)(r,function(){return m}),null}),tm=t(89169),tv=t(96288),tx=t(52464),ty=t(61395),tZ=(r=(0,n8.Z)((0,n6.Z)().mark(function e(n){var t;return(0,n6.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={message:"response error, status: ".concat(n.statusText),type:n.status},e.abrupt("return",t);case 2:case"end":return e.stop()}},e)})),function(e){return r.apply(this,arguments)}),tC=(a=(0,n8.Z)((0,n6.Z)().mark(function e(n){var t,r,a,o,i,s,l,c,u,d,p,g,f,h,m=arguments;return(0,n6.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=m.length>1&&void 0!==m[1]?m[1]:{},e.next=3,n();case 3:if((r=e.sent).ok){e.next=10;break}return e.next=7,tZ(r);case 7:return o=e.sent,null===(a=t.onErrorHandle)||void 0===a||a.call(t,o),e.abrupt("return");case 10:if(i=r.clone(),s=r.body){e.next=14;break}return e.abrupt("return");case 14:l=s.getReader(),c=new TextDecoder,u=!1;case 17:if(u){e.next=28;break}return e.next=20,l.read();case 20:g=(p=e.sent).value,u=f=p.done,h=c.decode(g,{stream:!f}),null===(d=t.onMessageHandle)||void 0===d||d.call(t,h,i),e.next=17;break;case 28:return e.abrupt("return",i);case 29:case"end":return e.stop()}},e)})),function(e){return a.apply(this,arguments)}),tb=(0,t(14181).k)("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",8),tk={historyCount:1,model:"gpt-3.5-turbo",params:{frequency_penalty:0,presence_penalty:0,temperature:.6,top_p:1},systemRole:""},tM={chats:[],init:!0,displayMode:"chat",userMeta:{avatar:"https://static.vecteezy.com/system/resources/previews/022/123/337/original/user-icon-profile-icon-account-icon-login-sign-line-vector.jpg"},assistantMeta:{avatar:"https://static.vecteezy.com/system/resources/previews/021/059/827/non_2x/chatgpt-logo-chat-gpt-icon-on-white-background-free-vector.jpg"},config:tk},tw=t(4942),tj=t(29146),tS=function(e,n){switch(n.type){case"addMessage":return(0,tj.Uy)(e,function(e){var t=n.id||tb();e.push({content:n.message,createAt:Date.now(),id:t,parentId:n.parentId,role:n.role,updateAt:Date.now()})});case"deleteMessage":return e.map(function(e){return e.id!==n.id&&e}).filter(Boolean);case"updateMessage":return(0,tj.Uy)(e,function(e){var t=n.id,r=n.key,a=n.value,o=e.find(function(e){return e.id===t});o&&(o[r]=a,o.updateAt=Date.now())});case"updateMessageExtra":return(0,tj.Uy)(e,function(e){var t=n.id,r=n.key,a=n.value,o=e.find(function(e){return e.id===t});o&&(o.extra?o.extra[r]=a:o.extra=(0,tw.Z)({},r,a),o.updateAt=Date.now())});case"resetMessages":return[];default:throw Error("暂未实现的 type，请检查 reducer")}},tT=function(e,n){var t=["chat/message",e].filter(Boolean).join("/");return n?{payload:n,type:t}:t},tN=function(e,n){var t,r,a,o,i,s;return{clearMessage:((0,n8.Z)((0,n6.Z)().mark(function e(){var t,r,a;return(0,n6.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(t=n()).dispatchMessage,!(a=t.onResetMessage)){e.next=4;break}return e.next=4,a();case 4:r({type:"resetMessages"});case 5:case"end":return e.stop()}},e)})),function(){}),deleteMessage:function(e){},updateMessageContent:(t=(0,n8.Z)((0,n6.Z)().mark(function e(t,r){var a,o,i;return(0,n6.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o=(a=n()).dispatchMessage,i=a.updateMessageContent,o({id:t,key:"content",type:"updateMessage",value:r}),i(t,r);case 3:case"end":return e.stop()}},e)})),function(e,n){return t.apply(this,arguments)}),dispatchMessage:function(t){var r=n(),a=r.chats,o=r.onChatsChange,i=tS(a,t);e({chats:i},!1,tT("dispatchMessage")),null==o||o(i)},generateMessage:(r=(0,n8.Z)((0,n6.Z)().mark(function e(t,r){var a,o,i,s,l,c,u,d,p,g,f,h,m,v,x,y,Z,C,b,k,M;return(0,n6.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=(a=n()).dispatchMessage,i=a.toggleChatLoading,s=a.config,l=a.defaultModelFetcher,c=a.createSmoothMessage,u=a.transformToChatMessage,d=a.updateMessageContent,p=i(!0,r,tT("generateMessage(start)",{assistantId:r,messages:t})),g=nF(t,s),f=function(e){var n=(0,ty.Z)(s.inputTemplate,{interpolate:/{{([\S\s]+?)}}/g});return e.map(function(e){if("user"===e.role)try{return(0,en.Z)((0,en.Z)({},e),{},{content:n({text:e.content})})}catch(e){console.error(e)}return e})},h=s.inputTemplate?f(g):g,s.systemRole&&h.unshift({content:s.systemRole,role:"system"}),m=function(){return l((0,en.Z)({messages:h,model:s.model},s.params),{signal:null==p?void 0:p.signal})},v="",x=!1,Z=(y=c(r)).startAnimation,C=y.stopAnimation,b=y.outputQueue,k=y.isAnimationActive,e.next=12,tC(m,{onErrorHandle:function(e){o({id:r,key:"error",type:"updateMessage",value:e})},onAbort:function(){var e=(0,n8.Z)((0,n6.Z)().mark(function e(){return(0,n6.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:C();case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),onFinish:function(){var e=(0,n8.Z)((0,n6.Z)().mark(function e(n){return(0,n6.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(C(),!(b.length>0&&!x)){e.next=4;break}return e.next=4,Z(15);case 4:return e.next=6,d(r,n);case 6:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}(),onMessageHandle:function(){var e=(0,n8.Z)((0,n6.Z)().mark(function e(n){return(0,n6.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(v+=n,k||x||Z(),!(null!=p&&p.signal.aborted)){e.next=6;break}return e.abrupt("return");case 6:if(e.t0=b,!u){e.next=13;break}return e.next=10,u(n,v);case 10:e.t1=e.sent,e.next=14;break;case 13:e.t1=n;case 14:e.t2=e.t1,e.t0.push.call(e.t0,e.t2);case 16:v.startsWith('{"function')&&(x=!0);case 17:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}()});case 12:return function e(){clearTimeout(M),void 0===b||0===b.length||""===b.toString()?(i(!1,void 0,tT("generateMessage(end)")),clearTimeout(M)):M=setTimeout(e,30)}(),e.abrupt("return",{isFunctionCall:x});case 15:case"end":return e.stop()}},e)})),function(e,n){return r.apply(this,arguments)}),realFetchAIResponse:(a=(0,n8.Z)((0,n6.Z)().mark(function e(t,r){var a,o,i,s,l,c;return(0,n6.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=(a=n()).dispatchMessage,i=a.generateMessage,s=a.config,l=a.getMessageId,e.next=3,l(t,r);case 3:return o({id:c=e.sent,message:"...",parentId:r,role:"assistant",type:"addMessage"}),o({id:c,key:"fromModel",type:"updateMessageExtra",value:s.model}),e.next=8,i(t,c);case 8:case"end":return e.stop()}},e)})),function(e,n){return a.apply(this,arguments)}),resendMessage:(o=(0,n8.Z)((0,n6.Z)().mark(function e(t){var r,a,o,i,s,l,c,u;return(0,n6.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!((a=(r=nU.currentChats(n())).findIndex(function(e){return e.id===t}))<0)){e.next=4;break}return e.abrupt("return");case 4:o=r[a],i=[],e.t0=o.role,e.next="function"===e.t0?9:"user"===e.t0?9:"assistant"===e.t0?11:15;break;case 9:return i=r.slice(0,a+1),e.abrupt("break",15);case 11:return s=o.parentId,l=r.findIndex(function(e){return e.id===s}),i=r.slice(0,l<0?a+1:l+1),e.abrupt("break",15);case 15:if(!(i.length<=0)){e.next=17;break}return e.abrupt("return");case 17:if(c=n().realFetchAIResponse,u=i.filter(function(e){return"user"===e.role}).at(-1)){e.next=21;break}return e.abrupt("return");case 21:return e.next=23,c(i,u.id);case 23:case"end":return e.stop()}},e)})),function(e){return o.apply(this,arguments)}),sendMessage:(i=(0,n8.Z)((0,n6.Z)().mark(function e(t){var r,a,o,i,s;return(0,n6.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=(r=n()).dispatchMessage,o=r.realFetchAIResponse,t){e.next=3;break}return e.abrupt("return");case 3:return a({id:i=tb(),message:t,role:"user",type:"addMessage"}),s=nU.currentChats(n()),e.next=8,o(s,i);case 8:case"end":return e.stop()}},e)})),function(e){return i.apply(this,arguments)}),stopGenerateMessage:function(){var e=n(),t=e.abortController,r=e.toggleChatLoading,a=e.chatLoadingId,o=e.chats,i=e.dispatchMessage;o&&o.length>0&&"..."===o[o.length-1].content&&i({id:a,key:"content",type:"updateMessage",value:""}),t&&(t.abort(),r(!1))},toggleChatLoading:function(n,t,r){if(n){var a=new AbortController;return e({abortController:a,chatLoadingId:t},!1,r),a}e({abortController:void 0,chatLoadingId:void 0},!1,r)},defaultModelFetcher:function(e,t){var r=n().request,a=(0,tm.Z)((0,en.Z)({model:tk.model,stream:!0},tk.params),e);if("function"==typeof r)return r(a.messages,a,null==t?void 0:t.signal);var o="string"==typeof r?r:"/api/openai/chat";return fetch(o,{body:JSON.stringify(a),headers:{"Content-Type":"application/json"},method:"POST",signal:null==t?void 0:t.signal})},getMessageId:(s=(0,n8.Z)((0,n6.Z)().mark(function e(t,r){var a;return(0,n6.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("function"!=typeof(a=n().genMessageId)){e.next=3;break}return e.abrupt("return",a(t,r));case 3:return e.abrupt("return",tb());case 4:case"end":return e.stop()}},e)})),function(e,n){return s.apply(this,arguments)}),createSmoothMessage:function(e){var t=n().dispatchMessage,r="",a=[],o=null,i=!1;return{startAnimation:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return new Promise(function(s){if(i){s();return}i=!0,function l(){i||(clearTimeout(o),o=null,s()),a.length>0?(t({id:e,key:"content",type:"updateMessage",value:r+=a.splice(0,n).join("")}),o=setTimeout(l,16)):(i=!1,o=null,s())}()})},stopAnimation:function(){i=!1,null!==o&&(clearTimeout(o),o=null)},outputQueue:a,isAnimationActive:!1}},getChatLoadingId:function(){return n().chatLoadingId}}},tR=["loading","initialChats","chats"],tE=function(e){var n=e.loading,t=e.initialChats,r=e.chats,a=(0,et.Z)(e,tR);return function(){var e=null!=r?r:t,o=(0,tm.Z)({},tM,(0,en.Z)({init:!n,chats:Array.isArray(e)?e:Object.values(e||{})},a));return(0,en.Z)((0,en.Z)({},o),tN.apply(void 0,arguments))}},tz=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=(0,tv.v)(!1!==n),r=!1===n?void 0:!0===n?{name:"PRO_CHAT"}:n;return(0,tx.F)()(t(tE(e),r),nj())},tA=["children","devtoolOptions","chats","onChatsChange","loading","helloMessage","userMeta","inputAreaProps","assistantMeta","actions","transformToChatMessage","request","locale"],tD=(0,J.memo)(function(e){var n=e.children,t=e.devtoolOptions,r=e.chats,a=e.onChatsChange,o=e.loading,i=e.helloMessage,s=e.userMeta,l=e.inputAreaProps,c=e.assistantMeta,u=e.actions,d=e.transformToChatMessage,p=e.request,g=e.locale,f=(0,et.Z)(e,tA),h=!0,m=(0,eu.jsxs)(eu.Fragment,{children:[n,(0,eu.jsx)(th,{chatRef:f.chatRef,init:!o,helloMessage:i,chats:r,actions:u,userMeta:s,request:p,transformToChatMessage:d,inputAreaProps:l,assistantMeta:c,onChatsChange:a,locale:g})]});try{nA()}catch(e){h=!1}return h?m:(0,eu.jsx)(nD,{createStore:function(){return tz(f,t)},children:m})}),tI=["renderInputArea","__PRO_CHAT_STORE_DEVTOOLS__","showTitle","style","className","chatItemRenderConfig","backToBottomConfig","appStyle","inputRender","markdownProps","renderErrorMessages","inputAreaRender","itemShouldUpdate","onScroll","sendButtonRender"];function tP(e){var n=e.renderInputArea,t=e.__PRO_CHAT_STORE_DEVTOOLS__,r=e.showTitle,a=e.style,o=e.className,i=e.chatItemRenderConfig,s=e.backToBottomConfig,l=e.appStyle,c=e.inputRender,u=e.markdownProps,d=e.renderErrorMessages,p=e.inputAreaRender,g=e.itemShouldUpdate,f=e.onScroll,h=e.sendButtonRender,m=(0,et.Z)(e,tI);return(0,eu.jsx)(tD,(0,en.Z)((0,en.Z)({},m),{},{devtoolOptions:t,children:(0,eu.jsx)(er.Z,{style:(0,en.Z)({height:"100%",width:"100%",position:"relative"},l),className:o,children:(0,eu.jsx)(tp,{chatItemRenderConfig:i,inputRender:c,sendButtonRender:h,inputAreaRender:n||p,chatRef:m.chatRef,showTitle:r,style:a,onScroll:f,itemShouldUpdate:g,renderErrorMessages:d,backToBottomConfig:s,className:o,markdownProps:u})})}))}var tB=t(88767),tH=t(45354),tF=()=>{let{data:e,error:n,refetch:t,isLoading:r}=(0,tB.useQuery)("chat-history",$.Z.getChatHistory,{staleTime:tH.ok,keepPreviousData:!0,cacheTime:tH.bQ,refetchOnWindowFocus:!1});return{chatHistory:e,chatHistoryError:n,refetchChatList:t,chatLoading:r}},tO=t(11163),tL=t(37106),t_=t(16829);function tU(){let e=(0,Y._)(["\n  .ant-float-btn > div {\n    background: #252525;\n    svg {\n      fill: #fff;\n    }\n    &:hover {\n      background-color: #252525;\n    }\n  }\n"]);return tU=function(){return e},e}let{Search:tW}=K.default,tX=()=>{let[e,n]=(0,J.useState)(!1),t=(0,ee.Fg)(),r=(0,tO.useRouter)(),a=async e=>{try{n(!0);let t=await $.Z.chat(e);return t.content}catch(e){console.log("error",e)}finally{n(!1)}},o=async e=>{let n=await a(e);return new Promise(e=>{setTimeout(()=>{e(n||"")},2e3)})},{chatHistory:i,chatLoading:s}=tF();return(0,q.tZ)("div",{className:"side-item search-bar",children:s?(0,q.tZ)(eD,{}):(0,q.BX)("div",{style:{background:t.colorBgLayout},children:[(0,q.tZ)(tP,{request:async e=>{var n;let t=await o(null==e?void 0:null===(n=e[(null==e?void 0:e.length)-1])||void 0===n?void 0:n.content);return new Response(t)},style:{height:"100vh"},initialChats:(null==i?void 0:i.map(e=>({...e,createAt:e.created_at,updateAt:e.created_at,role:"user"===e.owner?"user":"system",error:void 0})))||[]}),(0,q.tZ)(tV,{children:(0,q.tZ)(Q.Z,{shape:"circle",type:"primary",style:{top:15,bottom:"100vh",left:10,backgroundColor:"transparent"},icon:(0,q.tZ)(tL.CfO,{}),tooltip:(0,q.tZ)("div",{children:"Trang chủ"}),onClick:()=>{r.push("/")}})})]})})},tV=t_.Z.div(tU());var tG=()=>(0,q.tZ)(tX,{})}}]);